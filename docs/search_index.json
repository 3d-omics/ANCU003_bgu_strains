[["index.html", "3D’omics | BGU strain gene expression analysis Ongoing study Chapter 1 Introduction 1.1 Prepare the R environment", " 3D’omics | BGU strain gene expression analysis Ongoing study Antton Alberdi1 2025-01-14 Chapter 1 Introduction This webbook contains all the code used for the study on the effect of probiotics on Salmonella infection in broiler chicken. 1.1 Prepare the R environment 1.1.1 Environment To reproduce all the analyses locally, clone this repository in your computer using: RStudio &gt; New Project &gt; Version Control &gt; Git And indicating the following git repository: https://github.com/3d-omics/ANCU003_bgu_strains.git Once the R project has been created, follow the instructions and code chunks shown in this webbook. 1.1.2 Libraries The following R packages are required for the data analysis. # Base library(R.utils) library(knitr) library(tidyverse) library(devtools) library(tinytable) library(broom) library(broom.mixed) # For tree handling library(ape) library(phyloseq) library(phytools) # For plotting library(ggplot2) library(ggrepel) library(ggpubr) library(ggnewscale) library(gridExtra) library(ggtreeExtra) library(ggtree) library(ggh4x) library(corrplot) # For statistics library(microbiome) library(spaa) library(vegan) library(Rtsne) library(geiger) library(hilldiv2) library(distillR) library(ANCOMBC) library(lme4) library(Hmsc) library(igraph) University of Copenhagen, antton.alberdi@sund.ku.dk↩︎ "],["overview.html", "Chapter 2 Overview 2.1 Load data 2.2 Basic statistics 2.3 Carbohydrate active enzymes 2.4 KEGG 2.5 4-bacteria mix", " Chapter 2 Overview Note this is a rapid preliminary analysis, so results should not be interpreted as conclusive, as better methods exist to analyse the details. 2.1 Load data Data are loaded from the repository, while the metadata are directly fetched from the 3D’omics Airtable database. gene_counts &lt;- read_tsv(&quot;data/gene_counts.tsv&quot;) %&gt;% select(-Chr,-Start,-End,-Strand,-Length) %&gt;% pivot_longer(!Geneid, names_to=&quot;sample&quot;, values_to=&quot;count&quot;) %&gt;% separate(sample, into=c(&quot;sample&quot;, &quot;library&quot;),sep=&quot;\\\\.&quot;) %&gt;% group_by(Geneid,sample) %&gt;% summarise(count=sum(count)) %&gt;% dplyr::rename(gene=Geneid) gene_counts_relative &lt;- gene_counts %&gt;% group_by(sample) %&gt;% mutate(total=sum(count)) %&gt;% rowwise() %&gt;% mutate(count=count/total) %&gt;% select(gene,sample,count) gene_annotations &lt;- read_tsv(&quot;data/dram.annotations.tsv.gz&quot;) %&gt;% dplyr::rename(gene=1,genome=2,contig=3) %&gt;% mutate(gene = gsub(&quot;BGU:[^ ]*BGU:&quot;, &quot;BGU:&quot;, gene)) # fix naming error genomes &lt;- gene_annotations$genome %&gt;% unique() sample_metadata &lt;- airtable(&quot;tbloNr4f94CbNSka2&quot;, &quot;app94YGZqsqwARtWo&quot;) %&gt;% read_airtable(., fields = c(&quot;ID&quot;,&quot;Bacteria&quot;), id_to_col = TRUE) %&gt;% dplyr::rename(sample=ID) %&gt;% unnest(Bacteria) %&gt;% select(-airtable_record_id) sample_metadata %&gt;% write_tsv(&quot;data/sample_metadata.tsv&quot;) kegg_functions &lt;- read_csv(&quot;data/kegg_functions_pivoted_clean.csv&quot;) 2.2 Basic statistics gene_counts %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% ggplot(aes(x=count, y=Bacteria)) + geom_col() gene_counts %&gt;% separate(gene,into=c(&quot;bin&quot;,&quot;genome1&quot;,&quot;genome2&quot;),sep=&quot;_&quot;, remove = FALSE) %&gt;% mutate(genome=str_c(genome1,&quot; &quot;,genome2)) %&gt;% mutate(genome = sub(&quot;^(\\\\w)&quot;, &quot;\\\\U\\\\1&quot;, genome, perl = TRUE)) %&gt;% select(gene,genome,sample,count) %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% filter(genome == Bacteria) %&gt;% group_by(Bacteria) %&gt;% summarise( genes = n(), expressed = sum(count &gt; 1000) ) %&gt;% mutate(percentage=expressed/genes*100) %&gt;% tt() 2.3 Carbohydrate active enzymes 2.3.1 CAZY vs. non-CAZY gene expression gene_counts %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% left_join(gene_annotations, by=&quot;gene&quot;) %&gt;% separate_rows(cazy_ids, sep = &quot;; &quot;) %&gt;% mutate(cazy=ifelse(!is.na(cazy_ids),&quot;cazy&quot;,&quot;no_cazy&quot;)) %&gt;% select(Bacteria,count,cazy) %&gt;% group_by(Bacteria,cazy) %&gt;% summarise(count=sum(count)) %&gt;% ggplot(aes(x=count, y=Bacteria, fill=cazy)) + geom_col() 2.3.2 CAZY families gene_counts %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% left_join(gene_annotations, by=&quot;gene&quot;) %&gt;% separate_rows(cazy_ids, sep = &quot;; &quot;) %&gt;% filter(!is.na(cazy_ids)) %&gt;% select(Bacteria,cazy_ids,count) %&gt;% separate(cazy_ids,into=&quot;cazy2&quot;,sep=&quot;_&quot;, remove=FALSE) %&gt;% group_by(Bacteria,cazy2,count) %&gt;% summarise(count=sum(count)) %&gt;% filter(count&gt;1000) %&gt;% mutate(cazy1=str_sub(cazy2, 1, 2)) %&gt;% ggplot(aes(x=Bacteria,y=cazy2,fill=log(count)))+ geom_tile() + scale_fill_gradient2(low = &quot;white&quot;, high =&quot;black&quot;) + facet_nested(cazy1 ~ ., space=&quot;free&quot;, scales=&quot;free&quot;) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) 2.4 KEGG top_genes &lt;- gene_counts_relative %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% left_join(gene_annotations, by=&quot;gene&quot;) %&gt;% #filter(!is.na(ko_id)) %&gt;% select(Bacteria,ko_id,count) %&gt;% #filter(Bacteria==&quot;Bacteroides uniformis&quot;) %&gt;% group_by(Bacteria,ko_id) %&gt;% summarise(count=sum(count)) %&gt;% filter(!is.na(ko_id)) %&gt;% filter(count&gt;0.001) %&gt;% arrange(-count) top_genes_sort &lt;- top_genes %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count)) %&gt;% arrange(-count) %&gt;% pull(ko_id) top_genes %&gt;% mutate(ko_id=factor(ko_id,levels=top_genes_sort)) %&gt;% ggplot(aes(y=Bacteria,x=ko_id,fill=-log(count))) + geom_tile() + scale_fill_gradient2(low = &quot;white&quot;, high =&quot;black&quot;) gene_counts_relative %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% left_join(gene_annotations, by=&quot;gene&quot;) %&gt;% select(Bacteria,ko_id,count) %&gt;% filter(Bacteria!=&quot;Ruminococcus gnavus&quot;) %&gt;% filter(Bacteria!=&quot;Mix cultures&quot;) %&gt;% group_by(Bacteria,ko_id) %&gt;% summarise(count=sum(count)) %&gt;% left_join(kegg_functions, by=join_by(&quot;ko_id&quot;==&quot;kegg&quot;)) %&gt;% filter(!is.na(ko_id)) %&gt;% filter(count&gt;0.001) %&gt;% ggplot(aes(y=count,x=fct_reorder(ko_id,-log(count)), fill=kegg_function)) + geom_col(width=2) + facet_wrap(Bacteria ~ ., scale=&quot;free&quot;)+ theme(axis.text.x=element_blank(), axis.ticks.x=element_blank(), legend.position=&quot;bottom&quot;) + labs(y=&quot;Relative abundance&quot;,x=&quot;KEGG module&quot;,fill=&quot;Metabolic function&quot;) function_counts &lt;- gene_counts %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% left_join(gene_annotations, by=&quot;gene&quot;) %&gt;% left_join(kegg_functions, by=join_by(&quot;ko_id&quot;==&quot;kegg&quot;)) %&gt;% filter(!is.na(kegg_function)) %&gt;% group_by(Bacteria,kegg_function) %&gt;% summarise(count=sum(count)) function_counts %&gt;% ggplot(aes(x=count,y=Bacteria, fill=kegg_function, group=kegg_function)) + geom_bar(stat=&quot;identity&quot;, colour=&quot;white&quot;, linewidth=0.1) 2.5 4-bacteria mix gene_counts %&gt;% separate(gene,into=c(&quot;bin&quot;,&quot;genome1&quot;,&quot;genome2&quot;),sep=&quot;_&quot;, remove = FALSE) %&gt;% mutate(genome=str_c(genome1,&quot; &quot;,genome2)) %&gt;% mutate(genome = sub(&quot;^(\\\\w)&quot;, &quot;\\\\U\\\\1&quot;, genome, perl = TRUE)) %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% filter(Bacteria==&quot;Mix cultures&quot;) %&gt;% group_by(genome) %&gt;% summarise(count=sum(count)) %&gt;% filter(count&gt;10000) %&gt;% ggplot(aes(y=fct_reorder(genome, count),x=count)) + geom_col() "],["mix-vs-isolates.html", "Chapter 3 Mix vs isolates 3.1 Butyrivibrio fibrosolvens 3.2 Megasphaera elsdenii 3.3 Prevotella ruminicola 3.4 Eubacterium hallii", " Chapter 3 Mix vs isolates 3.1 Butyrivibrio fibrosolvens gene_counts_pair &lt;- gene_counts %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;)) %&gt;% mutate(sample = case_when( sample == &quot;C300216&quot; ~ &quot;mix&quot;, sample == &quot;C300205&quot; ~ &quot;isolate&quot;, TRUE ~ sample # Retain other values as-is )) %&gt;% filter(str_detect(gene, &quot;butyrivibrio_fibrisolvens&quot;)) %&gt;% group_by(sample) %&gt;% mutate(total=sum(count)) %&gt;% rowwise() %&gt;% mutate(count=count/total) %&gt;% select(gene,sample,count) %&gt;% pivot_wider(names_from = sample, values_from = count) %&gt;% filter(if_all(everything(), ~ . != 0)) %&gt;% left_join(gene_annotations,by=&quot;gene&quot;) # Top overexpression in mixture gene_counts_pair %&gt;% mutate(difference_abs = mix-isolate) %&gt;% mutate(difference_rel = mix/isolate) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idalzfgzgfaba6u3egtz2w, .table th.tinytable_css_idalzfgzgfaba6u3egtz2w { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_butyrivibrio_fibrisolvens@contig_00000037_67 0.6913029425 3.839056e-04 0.6909190370 1800.71091 K02406 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000033_17 0.0029233581 3.411274e-05 0.0028892454 85.69696 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000037_66 0.0008101721 1.296236e-05 0.0007972098 62.50189 K02406 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000028_53 0.0003295093 5.347273e-06 0.0003241620 61.62192 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000033_79 0.0045986673 8.629640e-05 0.0045123709 53.28922 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000037_78 0.0008453465 1.611343e-05 0.0008292331 52.46222 K06603 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000056_28 0.0003848748 9.859035e-06 0.0003750158 39.03778 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000050_14 0.0008213094 2.184266e-05 0.0007994667 37.60117 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000050_13 0.0009616062 2.573375e-05 0.0009358724 37.36751 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000037_76 0.0005473660 1.470500e-05 0.0005326610 37.22312 K02422 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000053_217 0.0013916308 3.838578e-05 0.0013532450 36.25381 K03406 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000028_35 0.0014897424 4.210978e-05 0.0014476327 35.37759 K02398 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000049_52 0.0001460657 4.153685e-06 0.0001419121 35.16534 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000037_77 0.0023844452 7.077975e-05 0.0023136655 33.68824 K02407 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000052_120 0.0003595557 1.112424e-05 0.0003484315 32.32183 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000040_13 0.0004335901 1.346367e-05 0.0004201265 32.20445 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000067_38 0.0001284385 4.010455e-06 0.0001244280 32.02592 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000067_39 0.0008069672 2.752413e-05 0.0007794431 29.31853 K05349 GH3 BGU:bin_butyrivibrio_fibrisolvens@contig_00000014_9 0.0004356333 1.542115e-05 0.0004202121 28.24907 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000056_29 0.0003654047 1.384562e-05 0.0003515591 26.39136 K03406 NA # Top overexpression in isolate gene_counts_pair %&gt;% mutate(difference_abs = isolate-mix) %&gt;% mutate(difference_rel = isolate/mix) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idnido66o10xqn1s2k4fbc, .table th.tinytable_css_idnido66o10xqn1s2k4fbc { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_butyrivibrio_fibrisolvens@contig_00000043_72 6.810526e-07 0.0021884432 0.0021877621 3213.3248 K07979 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000043_73 3.084768e-06 0.0058609456 0.0058578608 1899.9634 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000051_32 1.201857e-07 0.0001661952 0.0001660750 1382.8192 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000054_79 5.889102e-06 0.0077554558 0.0077495667 1316.9166 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000043_74 4.887554e-06 0.0048897948 0.0048849073 1000.4585 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000040_107 3.605572e-07 0.0003094973 0.0003091367 858.3860 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000018_17 4.839480e-05 0.0353979457 0.0353495509 731.4412 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000018_14 1.129746e-05 0.0074244262 0.0074131287 657.1766 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000051_33 1.922972e-06 0.0011379427 0.0011360197 591.7625 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000073_9 6.690340e-06 0.0034557230 0.0034490327 516.5243 K17686 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000018_16 3.108805e-05 0.0150585658 0.0150274777 484.3844 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000033_103 1.934991e-05 0.0092756808 0.0092563309 479.3657 K03705 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000018_13 6.009287e-07 0.0002874398 0.0002868389 478.3259 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000051_36 8.693436e-06 0.0041030534 0.0040943600 471.9714 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000049_85 6.009287e-07 0.0002760052 0.0002754043 459.2978 K02003 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000045_350 5.688792e-06 0.0023434663 0.0023377775 411.9444 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000045_352 1.017573e-05 0.0039143233 0.0039041476 384.6726 K13038 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000052_59 7.611764e-07 0.0002823551 0.0002815939 370.9457 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000018_12 2.119275e-05 0.0078419193 0.0078207266 370.0283 K03205 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000051_34 6.409907e-06 0.0023288091 0.0023223992 363.3140 NA NA 3.2 Megasphaera elsdenii gene_counts_pair &lt;- gene_counts %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300212&quot;)) %&gt;% mutate(sample = case_when( sample == &quot;C300216&quot; ~ &quot;mix&quot;, sample == &quot;C300212&quot; ~ &quot;isolate&quot;, TRUE ~ sample # Retain other values as-is )) %&gt;% filter(str_detect(gene, &quot;megasphaera_elsdenii&quot;)) %&gt;% group_by(sample) %&gt;% mutate(total=sum(count)) %&gt;% rowwise() %&gt;% mutate(count=count/total) %&gt;% select(gene,sample,count) %&gt;% pivot_wider(names_from = sample, values_from = count) %&gt;% filter(if_all(everything(), ~ . != 0)) %&gt;% left_join(gene_annotations,by=&quot;gene&quot;) # Top overexpression in mixture gene_counts_pair %&gt;% mutate(difference_abs = mix-isolate) %&gt;% mutate(difference_rel = mix/isolate) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_id7sw4fq9ju55lprxl8wzn, .table th.tinytable_css_id7sw4fq9ju55lprxl8wzn { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_megasphaera_elsdenii@contig_00000001_360 1.321895e-03 5.013303e-06 1.316882e-03 263.67743 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_600 5.124383e-04 2.848089e-06 5.095902e-04 179.92354 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_359 1.621488e-03 1.172547e-05 1.609762e-03 138.28769 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_249 3.673935e-02 9.981470e-04 3.574120e-02 36.80755 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_355 6.357784e-05 1.865415e-06 6.171242e-05 34.08241 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1884 1.996289e-03 5.969329e-05 1.936596e-03 33.44244 K06155 NA BGU:bin_megasphaera_elsdenii@contig_00000001_1885 1.701477e-03 5.133223e-05 1.650145e-03 33.14637 K00033 NA BGU:bin_megasphaera_elsdenii@contig_00000001_1886 1.633072e-03 5.154875e-05 1.581524e-03 31.68015 K25031 NA BGU:bin_megasphaera_elsdenii@contig_00000001_258 6.271772e-03 2.065448e-04 6.065227e-03 30.36520 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_260 3.330385e-02 1.223779e-03 3.208007e-02 27.21394 K03737 NA BGU:bin_megasphaera_elsdenii@contig_00000001_353 7.663359e-05 2.864745e-06 7.376885e-05 26.75058 K03092 NA BGU:bin_megasphaera_elsdenii@contig_00000001_259 4.885334e-04 1.845429e-05 4.700791e-04 26.47263 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_354 9.134430e-05 3.614242e-06 8.773006e-05 25.27343 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_341 2.544033e-04 1.037637e-05 2.440269e-04 24.51756 K00005 NA BGU:bin_megasphaera_elsdenii@contig_00000001_356 8.757468e-05 3.814108e-06 8.376057e-05 22.96072 K00046 NA BGU:bin_megasphaera_elsdenii@contig_00000001_362 3.469888e-04 1.527309e-05 3.317157e-04 22.71897 K09022 NA BGU:bin_megasphaera_elsdenii@contig_00000001_358 1.218230e-05 6.162532e-07 1.156605e-05 19.76834 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_599 1.777237e-04 9.077244e-06 1.686465e-04 19.57904 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_342 1.143895e-03 6.227489e-05 1.081621e-03 18.36849 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_608 2.426807e-04 1.412386e-05 2.285568e-04 17.18232 NA NA # Top overexpression in isolate gene_counts_pair %&gt;% mutate(difference_abs = isolate-mix) %&gt;% mutate(difference_rel = isolate/mix) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_id7d38k8qfcn26oy7anysr, .table th.tinytable_css_id7d38k8qfcn26oy7anysr { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_megasphaera_elsdenii@contig_00000001_299 2.473238e-05 7.798152e-03 7.773419e-03 315.30135 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_337 7.488669e-05 6.874105e-03 6.799218e-03 91.79341 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1955 1.838838e-07 1.480673e-05 1.462285e-05 80.52221 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_2190 1.245813e-05 9.234305e-04 9.109724e-04 74.12272 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1482 1.011361e-04 6.986047e-03 6.884910e-03 69.07569 K12950 NA BGU:bin_megasphaera_elsdenii@contig_00000001_1973 5.470544e-06 3.122072e-04 3.067367e-04 57.07059 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1970 5.378602e-06 2.990161e-04 2.936375e-04 55.59364 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_2189 2.059499e-05 1.083190e-03 1.062595e-03 52.59483 K00606 NA BGU:bin_megasphaera_elsdenii@contig_00000001_16 5.934851e-05 3.120140e-03 3.060792e-03 52.57318 K03310 NA BGU:bin_megasphaera_elsdenii@contig_00000001_1971 2.252577e-06 1.174545e-04 1.152020e-04 52.14229 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1485 1.267879e-04 6.452704e-03 6.325916e-03 50.89369 K04759 NA BGU:bin_megasphaera_elsdenii@contig_00000001_1963 9.470018e-06 4.340421e-04 4.245721e-04 45.83330 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1486 1.052735e-05 4.615570e-04 4.510297e-04 43.84361 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1966 6.895644e-06 2.870241e-04 2.801285e-04 41.62397 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1962 4.780980e-06 1.979339e-04 1.931529e-04 41.40027 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1964 2.160635e-05 7.946669e-04 7.730605e-04 36.77932 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1965 8.918366e-06 3.213844e-04 3.124660e-04 36.03624 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1967 3.355880e-06 1.169049e-04 1.135490e-04 34.83584 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1959 2.951336e-05 1.017701e-03 9.881872e-04 34.48271 K21636 NA BGU:bin_megasphaera_elsdenii@contig_00000001_1484 6.573847e-06 2.191863e-04 2.126124e-04 33.34216 K04758 NA 3.3 Prevotella ruminicola gene_counts_pair &lt;- gene_counts %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300214&quot;)) %&gt;% mutate(sample = case_when( sample == &quot;C300216&quot; ~ &quot;mix&quot;, sample == &quot;C300214&quot; ~ &quot;isolate&quot;, TRUE ~ sample # Retain other values as-is )) %&gt;% filter(str_detect(gene, &quot;prevotella_ruminicola&quot;)) %&gt;% group_by(sample) %&gt;% mutate(total=sum(count)) %&gt;% rowwise() %&gt;% mutate(count=count/total) %&gt;% select(gene,sample,count) %&gt;% pivot_wider(names_from = sample, values_from = count) %&gt;% filter(if_all(everything(), ~ . != 0)) %&gt;% left_join(gene_annotations,by=&quot;gene&quot;) # Top overexpression in mixture gene_counts_pair %&gt;% mutate(difference_abs = mix-isolate) %&gt;% mutate(difference_rel = mix/isolate) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idij68jkadr3nb23d45si0, .table th.tinytable_css_idij68jkadr3nb23d45si0 { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_prevotella_ruminicola@contig_00000007_53 2.339726e-03 1.948025e-05 2.320246e-03 120.10761 NA NA BGU:bin_prevotella_ruminicola@contig_00000004_430 9.622312e-03 1.002675e-04 9.522044e-03 95.96641 NA NA BGU:bin_prevotella_ruminicola@contig_00000007_28 2.046566e-03 3.223252e-05 2.014334e-03 63.49383 NA NA BGU:bin_prevotella_ruminicola@contig_00000004_218 6.605025e-04 1.043523e-05 6.500673e-04 63.29542 NA NA BGU:bin_prevotella_ruminicola@contig_00000004_513 7.862558e-04 1.337014e-05 7.728857e-04 58.80684 K21572 NA BGU:bin_prevotella_ruminicola@contig_00000003_1427 2.376222e-03 4.996212e-05 2.326260e-03 47.56048 NA NA BGU:bin_prevotella_ruminicola@contig_00000006_113 5.728322e-04 1.227170e-05 5.605605e-04 46.67913 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_458 1.580049e-03 4.009327e-05 1.539956e-03 39.40933 K00343 NA BGU:bin_prevotella_ruminicola@contig_00000006_115 7.545200e-04 1.970337e-05 7.348166e-04 38.29396 NA NA BGU:bin_prevotella_ruminicola@contig_00000004_278 8.453639e-04 2.227785e-05 8.230860e-04 37.94638 K21572 NA BGU:bin_prevotella_ruminicola@contig_00000004_279 2.066401e-03 5.466484e-05 2.011736e-03 37.80128 K21573 NA BGU:bin_prevotella_ruminicola@contig_00000006_114 1.601867e-03 4.307967e-05 1.558788e-03 37.18384 NA NA BGU:bin_prevotella_ruminicola@contig_00000004_514 7.501563e-04 2.236367e-05 7.277926e-04 33.54353 K21573 NA BGU:bin_prevotella_ruminicola@contig_00000003_457 1.528081e-03 4.589443e-05 1.482187e-03 33.29557 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_848 5.260615e-03 1.732112e-04 5.087404e-03 30.37111 NA NA BGU:bin_prevotella_ruminicola@contig_00000007_29 8.489342e-05 2.866257e-06 8.202716e-05 29.61822 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_455 1.154392e-04 4.102008e-06 1.113372e-04 28.14211 K00340 NA BGU:bin_prevotella_ruminicola@contig_00000003_456 1.700248e-03 6.182190e-05 1.638427e-03 27.50237 K00341 NA BGU:bin_prevotella_ruminicola@contig_00000004_508 6.577256e-04 2.471503e-05 6.330106e-04 26.61238 K21572 NA BGU:bin_prevotella_ruminicola@contig_00000009_11 2.261180e-05 9.096503e-07 2.170215e-05 24.85768 NA NA # Top overexpression in isolate gene_counts_pair %&gt;% mutate(difference_abs = isolate-mix) %&gt;% mutate(difference_rel = isolate/mix) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idwifgk9lkfyi3ltl4n5r8, .table th.tinytable_css_idwifgk9lkfyi3ltl4n5r8 { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_prevotella_ruminicola@contig_00000003_950 8.727360e-06 3.270691e-03 3.261963e-03 374.76288 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_949 3.173586e-05 8.547933e-03 8.516197e-03 269.34621 NA NA BGU:bin_prevotella_ruminicola@contig_00000007_107 7.933964e-07 4.682125e-05 4.602785e-05 59.01369 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_951 3.173586e-05 1.486008e-03 1.454272e-03 46.82427 K11921 NA BGU:bin_prevotella_ruminicola@contig_00000007_22 2.062831e-05 7.751766e-04 7.545482e-04 37.57829 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_948 8.965379e-05 2.919600e-03 2.829946e-03 32.56527 K03324 NA BGU:bin_prevotella_ruminicola@contig_00000004_600 2.316717e-04 6.538927e-03 6.307255e-03 28.22497 NA NA BGU:bin_prevotella_ruminicola@contig_00000004_194 4.800048e-04 1.283216e-02 1.235216e-02 26.73340 K00705 GH77 BGU:bin_prevotella_ruminicola@contig_00000004_267 7.469827e-04 1.957435e-02 1.882737e-02 26.20456 K21573 NA BGU:bin_prevotella_ruminicola@contig_00000007_21 1.233731e-04 3.128390e-03 3.005017e-03 25.35714 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_3 2.261180e-05 5.574612e-04 5.348494e-04 24.65355 NA NA BGU:bin_prevotella_ruminicola@contig_00000004_263 1.614562e-04 3.784712e-03 3.623256e-03 23.44111 NA GH13; GH13_14; GH13_1; GH13_32; GH13_36; GH13_5; GH13_6; GH13_7 BGU:bin_prevotella_ruminicola@contig_00000003_1329 2.261180e-05 5.101422e-04 4.875304e-04 22.56089 K07107 NA BGU:bin_prevotella_ruminicola@contig_00000003_516 1.808944e-04 4.063871e-03 3.882977e-03 22.46544 K03321 NA BGU:bin_prevotella_ruminicola@contig_00000007_115 1.983491e-06 4.395499e-05 4.197150e-05 22.16042 NA NA BGU:bin_prevotella_ruminicola@contig_00000008_110 3.887642e-05 8.398990e-04 8.010226e-04 21.60433 K00941 NA BGU:bin_prevotella_ruminicola@contig_00000008_109 6.132954e-04 1.258426e-02 1.197096e-02 20.51908 NA NA BGU:bin_prevotella_ruminicola@contig_00000008_111 1.824812e-05 3.464566e-04 3.282085e-04 18.98588 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_221 1.380510e-04 2.588401e-03 2.450350e-03 18.74961 K00764 NA BGU:bin_prevotella_ruminicola@contig_00000004_737 1.503486e-04 2.785847e-03 2.635498e-03 18.52925 K21573 NA 3.4 Eubacterium hallii gene_counts_pair &lt;- gene_counts %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300203&quot;)) %&gt;% mutate(sample = case_when( sample == &quot;C300216&quot; ~ &quot;mix&quot;, sample == &quot;C300203&quot; ~ &quot;isolate&quot;, TRUE ~ sample # Retain other values as-is )) %&gt;% filter(str_detect(gene, &quot;anaerobutyricum_hallii&quot;)) %&gt;% group_by(sample) %&gt;% mutate(total=sum(count)) %&gt;% rowwise() %&gt;% mutate(count=count/total) %&gt;% select(gene,sample,count) %&gt;% pivot_wider(names_from = sample, values_from = count) %&gt;% filter(if_all(everything(), ~ . != 0)) %&gt;% left_join(gene_annotations,by=&quot;gene&quot;) # Top overexpression in mixture gene_counts_pair %&gt;% mutate(difference_abs = mix-isolate) %&gt;% mutate(difference_rel = mix/isolate) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idbjrx52mv7s1ptvnqvhj1, .table th.tinytable_css_idbjrx52mv7s1ptvnqvhj1 { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_anaerobutyricum_hallii@contig_00000112_1 1.979828e-05 1.137796e-07 1.968450e-05 174.00562 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000079_8 2.602060e-04 3.204791e-06 2.570012e-04 81.19282 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000129_41 5.090987e-05 6.447509e-07 5.026512e-05 78.96053 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000147_18 7.919314e-05 1.024016e-06 7.816912e-05 77.33583 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000147_19 5.175837e-04 7.149149e-06 5.104346e-04 72.39794 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000147_23 5.175837e-04 7.187076e-06 5.103966e-04 72.01589 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000165_10 1.414163e-05 2.465224e-07 1.389511e-05 57.36449 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000165_9 1.696996e-05 3.034122e-07 1.666655e-05 55.93038 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000147_14 8.767811e-05 1.573951e-06 8.610416e-05 55.70576 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000147_25 1.668712e-04 3.223754e-06 1.636475e-04 51.76302 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000125_8 5.656653e-06 1.137796e-07 5.542873e-06 49.71589 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000147_40 7.070816e-05 1.441208e-06 6.926695e-05 49.06173 K06133 NA BGU:bin_anaerobutyricum_hallii@contig_00000134_20 6.787983e-05 1.384318e-06 6.649551e-05 49.03485 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000112_180 2.325167e-02 4.755796e-04 2.277609e-02 48.89122 K04759 NA BGU:bin_anaerobutyricum_hallii@contig_00000147_69 6.787983e-05 1.403281e-06 6.647655e-05 48.37222 K07171 NA BGU:bin_anaerobutyricum_hallii@contig_00000147_21 7.636481e-05 1.592914e-06 7.477189e-05 47.94032 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000151_7 1.979828e-05 4.361550e-07 1.936213e-05 45.39277 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000147_29 1.159614e-04 2.692783e-06 1.132686e-04 43.06376 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000094_1 4.242489e-05 1.024016e-06 4.140088e-05 41.42991 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000020_3 2.545494e-05 6.257876e-07 2.482915e-05 40.67664 NA NA # Top overexpression in isolate gene_counts_pair %&gt;% mutate(difference_abs = isolate-mix) %&gt;% mutate(difference_rel = isolate/mix) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idiy7ivwhloxop5qci5c47, .table th.tinytable_css_idiy7ivwhloxop5qci5c47 { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_anaerobutyricum_hallii@contig_00000045_7 8.484979e-05 5.686191e-03 5.601341e-03 67.01479 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000045_8 5.656653e-05 2.561671e-03 2.505105e-03 45.28599 K08600 NA BGU:bin_anaerobutyricum_hallii@contig_00000008_9 2.828326e-06 1.212701e-04 1.184417e-04 42.87697 K03671 NA BGU:bin_anaerobutyricum_hallii@contig_00000112_75 2.828326e-06 1.173826e-04 1.145543e-04 41.50249 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000048_1 8.484979e-06 3.339810e-04 3.254960e-04 39.36144 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000107_38 8.484979e-06 3.074893e-04 2.990043e-04 36.23925 K07738 NA BGU:bin_anaerobutyricum_hallii@contig_00000087_17 2.828326e-06 8.963934e-05 8.681101e-05 31.69342 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000025_3 1.668712e-04 4.818394e-03 4.651523e-03 28.87492 K07301 NA BGU:bin_anaerobutyricum_hallii@contig_00000112_91 3.111159e-05 8.975691e-04 8.664575e-04 28.84999 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000120_6 1.414163e-05 3.809150e-04 3.667734e-04 26.93572 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000132_16 5.656653e-06 1.517630e-04 1.461063e-04 26.82911 K06409 NA BGU:bin_anaerobutyricum_hallii@contig_00000070_9 2.064678e-04 5.267918e-03 5.061450e-03 25.51448 K20109 NA BGU:bin_anaerobutyricum_hallii@contig_00000083_11 1.696996e-04 3.988410e-03 3.818710e-03 23.50277 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000129_32 5.656653e-05 1.322536e-03 1.265969e-03 23.38018 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000154_9 2.828326e-05 6.436700e-04 6.153867e-04 22.75798 K01567 CE4 BGU:bin_anaerobutyricum_hallii@contig_00000099_1 5.656653e-06 1.256885e-04 1.200318e-04 22.21959 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000076_5 3.959657e-05 8.498765e-04 8.102799e-04 21.46339 K00059 NA BGU:bin_anaerobutyricum_hallii@contig_00000154_10 5.939485e-05 1.268434e-03 1.209039e-03 21.35595 K23242 NA BGU:bin_anaerobutyricum_hallii@contig_00000164_2 3.111159e-04 6.199242e-03 5.888126e-03 19.92583 K00973 NA BGU:bin_anaerobutyricum_hallii@contig_00000045_9 8.202146e-05 1.545809e-03 1.463788e-03 18.84640 NA NA "],["gene-selection.html", "Chapter 4 Gene selection 4.1 Expression-based 4.2 Sample-type based 4.3 Biology-based", " Chapter 4 Gene selection 4.1 Expression-based ko_counts &lt;- gene_counts_relative %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% left_join(gene_annotations,by=&quot;gene&quot;) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count)) %&gt;% arrange(-count) 4.1.1 Around 1% ko_counts %&gt;% filter(count&lt;0.01, count&gt;0.005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length)) %&gt;% arrange(-length) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idovjuhew2egw4o7sg8ox0, .table th.tinytable_css_idovjuhew2egw4o7sg8ox0 { border-bottom: solid 0.1em #d3d8dc; } ko_id count length K00626 0.005542714 5659 K01007 0.008767982 2408 K00074 0.009133758 1660 4.1.2 Around 0.1% ko_counts %&gt;% filter(count&lt;0.001, count&gt;0.0005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length)) %&gt;% arrange(-length) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idfuasdtohemwq7myfg45l, .table th.tinytable_css_idfuasdtohemwq7myfg45l { border-bottom: solid 0.1em #d3d8dc; } ko_id count length K21573 0.0006744114 88415 K03798 0.0006768806 17958 K04759 0.0005542715 15443 K21636 0.0005937435 15125 K00688 0.0007587446 14490 K01870 0.0005577068 12734 K03070 0.0008505736 11006 K02519 0.0005313208 10802 K01869 0.0005893866 9983 K05366 0.0005243013 9779 K03545 0.0006215087 8960 K06972 0.0005019884 8757 K03544 0.0005938841 8193 K06207 0.0005960268 7286 K01835 0.0006954549 6929 K00656 0.0007586614 6792 K01139 0.0005509690 6765 K01937 0.0006103056 6422 K01624 0.0006471548 6371 K01951 0.0005900107 6242 4.1.3 Around 0.01% ko_counts %&gt;% filter(count&lt;0.0001, count&gt;0.00005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length)) %&gt;% arrange(-length) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_id7z5gxbmwhtnso3djsoj0, .table th.tinytable_css_id7z5gxbmwhtnso3djsoj0 { border-bottom: solid 0.1em #d3d8dc; } ko_id count length K07133 7.824953e-05 21634 K07718 6.041119e-05 20766 K06921 5.162947e-05 17690 K06400 5.474285e-05 15752 K01153 6.306645e-05 15598 K01181 5.473145e-05 14806 K01198 7.083913e-05 13415 K07407 6.353259e-05 13367 K01811 8.198214e-05 11950 K03320 8.846964e-05 11917 K07052 7.211103e-05 11887 K09955 6.950561e-05 11623 K01448 8.737199e-05 11556 K01207 8.727443e-05 10211 K05989 6.379006e-05 10127 K01224 7.678649e-05 10071 K07814 6.202643e-05 9942 K06871 8.073274e-05 9557 K03497 5.815645e-05 9278 K01953 8.663135e-05 9091 4.1.4 Around 0.001% ko_counts %&gt;% filter(count&lt;0.00001, count&gt;0.000005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length)) %&gt;% arrange(-length) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idsxjjnwdjdxwfkoxovmqo, .table th.tinytable_css_idsxjjnwdjdxwfkoxovmqo { border-bottom: solid 0.1em #d3d8dc; } ko_id count length K04095 9.206968e-06 4708 K04784 7.999629e-06 4541 K00394 7.737603e-06 3436 K03573 8.306679e-06 2938 K17680 7.172314e-06 1895 K19090 7.072393e-06 1831 K21755 6.051859e-06 1804 K19075 8.511259e-06 1777 K10793 7.072833e-06 1757 K06295 5.266850e-06 1667 K06221 6.117371e-06 1660 K15584 8.348199e-06 1613 K02049 5.424155e-06 1522 K02036 5.278916e-06 1507 K20492 6.268725e-06 1471 K09792 9.983247e-06 1445 K03077 9.966891e-06 1420 K26113 7.150463e-06 1412 K20490 7.886312e-06 1408 K03564 6.324935e-06 1368 4.1.5 Around 0.0001% ko_counts %&gt;% filter(count&lt;0.000001, count&gt;0.0000005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length)) %&gt;% arrange(-length) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_iduj5yqlu2tqvixlqmzqw7, .table th.tinytable_css_iduj5yqlu2tqvixlqmzqw7 { border-bottom: solid 0.1em #d3d8dc; } ko_id count length K06390 7.715403e-07 962 K07813 7.461062e-07 584 K06396 5.712440e-07 572 K06393 9.859854e-07 386 4.2 Sample-type based 4.2.1 Flagellum-related genes (K02406, K06603, K02422, K02398, K02407) Overexpressed by Butyrivibrio fibrosolvens in mixture compared to isolation gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K02406|K06603|K02422|K02398|K02407&quot;)) %&gt;% left_join(gene_counts_relative,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(count)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idbjfhe0hxq436y20g1gxa, .table th.tinytable_css_idbjfhe0hxq436y20g1gxa { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300205 Butyrivibrio fibrosolvens 12 12504 1042 0.002086963 C300216 Mix cultures 12 12504 1042 0.352291881 4.2.2 Chemotaxis (K03406) Overexpressed by Butyrivibrio fibrosolvens in mixture compared to isolation gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K03406&quot;)) %&gt;% left_join(gene_counts_relative,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(count)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idpmh3hjl9pirk0vhz3xnw, .table th.tinytable_css_idpmh3hjl9pirk0vhz3xnw { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300205 Butyrivibrio fibrosolvens 19 33260 1750.526 3.648998e-03 C300216 Mix cultures 19 33260 1750.526 5.693450e-03 C300203 Eubacterium hallii 3 5025 1675.000 1.516901e-07 4.2.3 Glycoside Hydrolase Family 3 (GH3:K05349) Overexpressed by Butyrivibrio fibrosolvens in mixture compared to isolation Overexpressed by Prevotella ruminicola in isolation compared to mixture gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, &quot;GH3&quot;)) %&gt;% left_join(gene_counts_relative,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(count)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_ida1u420xcdgvc6fomqxih, .table th.tinytable_css_ida1u420xcdgvc6fomqxih { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 56 119974 2142.393 0.0023064209 C300205 Butyrivibrio fibrosolvens 28 59642 2130.071 0.0034808165 C300214 Prevotella ruminicola 26 57958 2229.154 0.0094791952 C300203 Eubacterium hallii 2 4036 2018.000 0.0000337700 C300212 Megasphaera elsdenii 1 1145 1145.000 0.0002134724 4.2.4 Glycoside Hydrolase Family 77 (GH77:K00705) Overexpressed by Prevotella ruminicola in isolation compared to mixture gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, &quot;GH77&quot;)) %&gt;% left_join(gene_counts_relative,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(count)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_ide7u8twyciauysdn0pack, .table th.tinytable_css_ide7u8twyciauysdn0pack { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 6 13206 2201.0 0.0007372497 C300203 Eubacterium hallii 3 4521 1507.0 0.0011176903 C300214 Prevotella ruminicola 2 5287 2643.5 0.0131067595 C300205 Butyrivibrio fibrosolvens 1 1529 1529.0 0.0002954816 C300212 Megasphaera elsdenii 1 3398 3398.0 0.0007189140 4.2.5 Gluconate metabolism (K00033, K25031,K07979, K06155) Overexpressed by Butyrivibrio fibrosolvens in isolation compared to mixture Overexpressed by Megasphaera elsdenii in mixture compared to isolation gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K00033|K25031|K07979|K06155&quot;)) %&gt;% left_join(gene_counts_relative,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(count)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idz7b1isavlastviza4z70, .table th.tinytable_css_idz7b1isavlastviza4z70 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 6 5406 901 2.338926e-03 C300212 Megasphaera elsdenii 3 4290 1430 1.625734e-04 C300203 Eubacterium hallii 2 742 371 2.880215e-05 C300205 Butyrivibrio fibrosolvens 1 374 374 2.187891e-03 4.2.6 ABC transporter (K02003) Overexpressed by Butyrivibrio fibrosolvens in mixture compared to isolation gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K02003&quot;)) %&gt;% left_join(gene_counts_relative,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(count)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idd1kfiotz91llvbvbipbr, .table th.tinytable_css_idd1kfiotz91llvbvbipbr { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 14 9934 709.5714 1.937191e-04 C300203 Eubacterium hallii 5 3535 707.0000 3.442227e-04 C300205 Butyrivibrio fibrosolvens 5 3547 709.4000 4.099416e-04 C300214 Prevotella ruminicola 3 2148 716.0000 3.051776e-03 C300212 Megasphaera elsdenii 1 704 704.0000 6.077558e-05 4.2.7 Manganese-transport (K12950) Overexpressed by Megasphaera elsdenii in isolation compared to mixture gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K12950&quot;)) %&gt;% left_join(gene_counts_relative,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(count)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idaah3itg7qagkd9wtxtsw, .table th.tinytable_css_idaah3itg7qagkd9wtxtsw { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300212 Megasphaera elsdenii 1 2093 2093 6.986011e-03 C300216 Mix cultures 1 2093 2093 4.436162e-05 4.2.8 Starch-binding (K21572, K21573) Overexpressed by Prevotella ruminicola in mixture compared to isolation gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K21572|K21573&quot;)) %&gt;% left_join(gene_counts_relative,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(count)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idtssyn9571g85z7rmwes2, .table th.tinytable_css_idtssyn9571g85z7rmwes2 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300214 Prevotella ruminicola 57 139737 2451.526 0.054505424 C300216 Mix cultures 57 139737 2451.526 0.001657431 4.2.9 Sortase (K08600) Overexpressed by Eubacterium hallii in isolation compared to mixture gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K08600&quot;)) %&gt;% left_join(gene_counts_relative,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(count)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_id44mlmq6e3bu1k4k8vycn, .table th.tinytable_css_id44mlmq6e3bu1k4k8vycn { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 7 5669 809.8571 0.0000916269 C300203 Eubacterium hallii 4 3092 773.0000 0.0029838005 C300205 Butyrivibrio fibrosolvens 3 2577 859.0000 0.0002420224 4.2.10 Thioredoxin (K03671) Overexpressed by Eubacterium hallii in isolation compared to mixture gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K03671&quot;)) %&gt;% left_join(gene_counts_relative,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(count)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idzx969abgvvcl658hqx0z, .table th.tinytable_css_idzx969abgvvcl658hqx0z { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 8 2554 319.25 0.0009136880 C300203 Eubacterium hallii 4 1238 309.50 0.0002248426 C300212 Megasphaera elsdenii 2 691 345.50 0.0005064243 C300205 Butyrivibrio fibrosolvens 1 311 311.00 0.0005342821 C300214 Prevotella ruminicola 1 314 314.00 0.0014804742 4.3 Biology-based 4.3.1 Carbohydrate esterase 4 (CE4) gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, &quot;CE4&quot;)) %&gt;% left_join(gene_counts_relative,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(count)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idh57aesxivjtdudzs0hre, .table th.tinytable_css_idh57aesxivjtdudzs0hre { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 13 11813 908.6923 0.0004353488 C300203 Eubacterium hallii 5 5203 1040.6000 0.0019442305 C300205 Butyrivibrio fibrosolvens 4 4169 1042.2500 0.0019242937 C300212 Megasphaera elsdenii 3 2517 839.0000 0.0006225625 C300214 Prevotella ruminicola 2 1387 693.5000 0.0001203307 4.3.2 Carbohydrate-Binding Module Family 48 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, &quot;CBM48&quot;)) %&gt;% left_join(gene_counts_relative,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(count)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_id4wunk3ycrbmj1r8qyrof, .table th.tinytable_css_id4wunk3ycrbmj1r8qyrof { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 4 8747 2186.75 0.0006386863 C300203 Eubacterium hallii 2 4012 2006.00 0.0008832344 C300205 Butyrivibrio fibrosolvens 2 4735 2367.50 0.0023053101 C300212 Megasphaera elsdenii 1 2108 2108.00 0.0009123999 4.3.3 GlycosylTransferase Family 5 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, &quot;GT5&quot;)) %&gt;% left_join(gene_counts_relative,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(count)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idmnoqi827m6fbvj0a2lyx, .table th.tinytable_css_idmnoqi827m6fbvj0a2lyx { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 21 33279 1584.714 0.001476375 C300203 Eubacterium hallii 7 13835 1976.429 0.003976081 C300205 Butyrivibrio fibrosolvens 6 8661 1443.500 0.002723462 C300214 Prevotella ruminicola 6 9246 1541.000 0.003405250 C300212 Megasphaera elsdenii 3 4266 1422.000 0.003590106 4.3.4 GlycosylTransferase Family 2 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, &quot;GT2&quot;)) %&gt;% left_join(gene_counts_relative,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(count&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(count)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_id8nt5o34btrepnyconew7, .table th.tinytable_css_id8nt5o34btrepnyconew7 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 88 92864 1055.273 0.001901803 C300205 Butyrivibrio fibrosolvens 45 49293 1095.400 0.005321795 C300214 Prevotella ruminicola 23 23773 1033.609 0.002186188 C300203 Eubacterium hallii 14 15085 1077.500 0.004508191 C300212 Megasphaera elsdenii 8 7747 968.375 0.001573220 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]

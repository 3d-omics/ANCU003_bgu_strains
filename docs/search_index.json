[["index.html", "3D’omics | BGU strain gene expression analysis Ongoing study Chapter 1 Introduction 1.1 Prepare the R environment", " 3D’omics | BGU strain gene expression analysis Ongoing study Antton Alberdi1 2025-01-28 Chapter 1 Introduction This webbook contains all the code used for the study on the effect of probiotics on Salmonella infection in broiler chicken. 1.1 Prepare the R environment 1.1.1 Environment To reproduce all the analyses locally, clone this repository in your computer using: RStudio &gt; New Project &gt; Version Control &gt; Git And indicating the following git repository: https://github.com/3d-omics/ANCU003_bgu_strains.git Once the R project has been created, follow the instructions and code chunks shown in this webbook. 1.1.2 Libraries The following R packages are required for the data analysis. # Base library(R.utils) library(knitr) library(tidyverse) library(devtools) library(tinytable) library(broom) library(broom.mixed) library(rairtable) # For tree handling library(ape) library(phyloseq) library(phytools) # For plotting library(ggplot2) library(ggrepel) library(ggpubr) library(ggnewscale) library(gridExtra) library(ggtreeExtra) library(ggtree) library(ggh4x) library(corrplot) # For statistics library(microbiome) library(spaa) library(vegan) library(Rtsne) library(geiger) library(hilldiv2) library(distillR) library(ANCOMBC) library(lme4) library(Hmsc) library(igraph) University of Copenhagen, antton.alberdi@sund.ku.dk↩︎ "],["overview.html", "Chapter 2 Overview 2.1 Load data 2.2 Basic statistics 2.3 Carbohydrate active enzymes 2.4 KEGG 2.5 4-bacteria mix", " Chapter 2 Overview Note this is a rapid preliminary analysis, so results should not be interpreted as conclusive, as better methods exist to analyse the details. 2.1 Load data Data are loaded from the repository, while the metadata are directly fetched from the 3D’omics Airtable database. gene_annotations &lt;- read_tsv(&quot;data/dram.annotations.tsv.gz&quot;) %&gt;% dplyr::rename(gene=1,genome=2,contig=3) %&gt;% mutate(gene = gsub(&quot;BGU:[^ ]*BGU:&quot;, &quot;BGU:&quot;, gene)) %&gt;% # fix naming error mutate(length=end_position-start_position) gene_counts &lt;- read_tsv(&quot;data/gene_counts.tsv&quot;) %&gt;% select(-Chr,-Start,-End,-Strand,-Length) %&gt;% pivot_longer(!Geneid, names_to=&quot;sample&quot;, values_to=&quot;raw&quot;) %&gt;% separate(sample, into=c(&quot;sample&quot;, &quot;library&quot;),sep=&quot;\\\\.&quot;) %&gt;% group_by(Geneid,sample) %&gt;% summarise(raw=sum(raw)) %&gt;% dplyr::rename(gene=Geneid) # Normalise by gene length gene_counts &lt;- gene_counts %&gt;% left_join(gene_annotations %&gt;% select(gene,length),by=&quot;gene&quot;) %&gt;% mutate(norm=raw*150/length) %&gt;% select(gene,sample,raw,norm) # Transform to relative abundances (per sample) gene_counts &lt;- gene_counts %&gt;% group_by(sample) %&gt;% mutate(total=sum(norm)) %&gt;% rowwise() %&gt;% mutate(rel=norm/total) %&gt;% select(gene,sample,raw,norm,rel) genomes &lt;- gene_annotations$genome %&gt;% unique() sample_metadata &lt;- airtable(&quot;tbloNr4f94CbNSka2&quot;, &quot;app94YGZqsqwARtWo&quot;) %&gt;% read_airtable(., fields = c(&quot;ID&quot;,&quot;Bacteria&quot;), id_to_col = TRUE) %&gt;% dplyr::rename(sample=ID) %&gt;% unnest(Bacteria) %&gt;% select(-airtable_record_id) sample_metadata %&gt;% write_tsv(&quot;data/sample_metadata.tsv&quot;) kegg_functions &lt;- read_csv(&quot;data/kegg_functions_pivoted_clean.csv&quot;) 2.2 Basic statistics 2.2.1 Sequencing depth per sample gene_counts %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% ggplot(aes(x=raw, y=Bacteria)) + geom_col() gene_counts %&gt;% separate(gene,into=c(&quot;bin&quot;,&quot;genome1&quot;,&quot;genome2&quot;),sep=&quot;_&quot;, remove = FALSE) %&gt;% mutate(genome=str_c(genome1,&quot; &quot;,genome2)) %&gt;% mutate(genome = sub(&quot;^(\\\\w)&quot;, &quot;\\\\U\\\\1&quot;, genome, perl = TRUE)) %&gt;% mutate(genome = str_remove(genome, &quot;@contig&quot;)) %&gt;% select(gene,genome,sample,raw) %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% filter(genome == Bacteria) %&gt;% group_by(Bacteria) %&gt;% summarise( genes = n(), expressed = sum(raw &gt; 1000) ) %&gt;% mutate(percentage=expressed/genes*100) %&gt;% tt() 2.3 Carbohydrate active enzymes 2.3.1 CAZY vs. non-CAZY gene expression 2.3.1.1 Raw reads gene_counts %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% left_join(gene_annotations, by=&quot;gene&quot;) %&gt;% separate_rows(cazy_ids, sep = &quot;; &quot;) %&gt;% mutate(cazy=ifelse(!is.na(cazy_ids),&quot;cazy&quot;,&quot;no_cazy&quot;)) %&gt;% select(Bacteria,raw,cazy) %&gt;% group_by(Bacteria,cazy) %&gt;% summarise(raw=sum(raw)) %&gt;% ggplot(aes(x=raw, y=Bacteria, fill=cazy)) + geom_col() 2.3.1.2 Gene-size normalised gene_counts %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% left_join(gene_annotations, by=&quot;gene&quot;) %&gt;% separate_rows(cazy_ids, sep = &quot;; &quot;) %&gt;% mutate(cazy=ifelse(!is.na(cazy_ids),&quot;cazy&quot;,&quot;no_cazy&quot;)) %&gt;% select(Bacteria,norm,cazy) %&gt;% group_by(Bacteria,cazy) %&gt;% summarise(norm=sum(norm)) %&gt;% ggplot(aes(x=norm, y=Bacteria, fill=cazy)) + geom_col() 2.3.2 CAZY families gene_counts %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% left_join(gene_annotations, by=&quot;gene&quot;) %&gt;% separate_rows(cazy_ids, sep = &quot;; &quot;) %&gt;% filter(!is.na(cazy_ids)) %&gt;% select(Bacteria,cazy_ids,norm) %&gt;% separate(cazy_ids,into=&quot;cazy2&quot;,sep=&quot;_&quot;, remove=FALSE) %&gt;% group_by(Bacteria,cazy2,norm) %&gt;% summarise(norm=sum(norm)) %&gt;% filter(norm&gt;10) %&gt;% mutate(cazy1=str_sub(cazy2, 1, 2)) %&gt;% ggplot(aes(x=Bacteria,y=cazy2,fill=log(norm)))+ geom_tile() + scale_fill_gradient2(low = &quot;white&quot;, high =&quot;black&quot;) + facet_nested(cazy1 ~ ., space=&quot;free&quot;, scales=&quot;free&quot;) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) 2.4 KEGG top_genes &lt;- gene_counts %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% left_join(gene_annotations, by=&quot;gene&quot;) %&gt;% #filter(!is.na(ko_id)) %&gt;% select(Bacteria,ko_id,rel) %&gt;% #filter(Bacteria==&quot;Bacteroides uniformis&quot;) %&gt;% group_by(Bacteria,ko_id) %&gt;% summarise(rel=sum(rel)) %&gt;% filter(!is.na(ko_id)) %&gt;% filter(rel&gt;0.001) %&gt;% arrange(-rel) top_genes_sort &lt;- top_genes %&gt;% group_by(ko_id) %&gt;% summarise(rel=mean(rel)) %&gt;% arrange(-rel) %&gt;% pull(ko_id) top_genes %&gt;% mutate(ko_id=factor(ko_id,levels=top_genes_sort)) %&gt;% ggplot(aes(y=Bacteria,x=ko_id,fill=-log(rel))) + geom_tile() + scale_fill_gradient2(low = &quot;white&quot;, high =&quot;black&quot;) gene_counts %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% left_join(gene_annotations, by=&quot;gene&quot;) %&gt;% select(Bacteria,ko_id,rel) %&gt;% filter(Bacteria!=&quot;Ruminococcus gnavus&quot;) %&gt;% filter(Bacteria!=&quot;Mix cultures&quot;) %&gt;% group_by(Bacteria,ko_id) %&gt;% summarise(rel=sum(rel)) %&gt;% left_join(kegg_functions, by=join_by(&quot;ko_id&quot;==&quot;kegg&quot;)) %&gt;% filter(!is.na(ko_id)) %&gt;% filter(rel&gt;0.001) %&gt;% ggplot(aes(y=rel,x=fct_reorder(ko_id,-log(rel)), fill=kegg_function)) + geom_col(width=2) + facet_wrap(Bacteria ~ ., scale=&quot;free&quot;)+ theme(axis.text.x=element_blank(), axis.ticks.x=element_blank(), legend.position=&quot;bottom&quot;) + labs(y=&quot;Relative abundance&quot;,x=&quot;KEGG module&quot;,fill=&quot;Metabolic function&quot;) function_counts &lt;- gene_counts %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% left_join(gene_annotations, by=&quot;gene&quot;) %&gt;% left_join(kegg_functions, by=join_by(&quot;ko_id&quot;==&quot;kegg&quot;)) %&gt;% filter(!is.na(kegg_function)) %&gt;% group_by(Bacteria,kegg_function) %&gt;% summarise(norm=sum(norm)) function_counts %&gt;% ggplot(aes(x=norm,y=Bacteria, fill=kegg_function, group=kegg_function)) + geom_bar(stat=&quot;identity&quot;, colour=&quot;white&quot;, linewidth=0.1) 2.5 4-bacteria mix gene_counts %&gt;% separate(gene,into=c(&quot;bin&quot;,&quot;genome1&quot;,&quot;genome2&quot;),sep=&quot;_&quot;, remove = FALSE) %&gt;% mutate(genome=str_c(genome1,&quot; &quot;,genome2)) %&gt;% mutate(genome = sub(&quot;^(\\\\w)&quot;, &quot;\\\\U\\\\1&quot;, genome, perl = TRUE)) %&gt;% left_join(sample_metadata, by=&quot;sample&quot;) %&gt;% filter(Bacteria==&quot;Mix cultures&quot;) %&gt;% group_by(genome) %&gt;% summarise(norm=sum(norm)) %&gt;% filter(norm&gt;1000) %&gt;% ggplot(aes(y=fct_reorder(genome, norm),x=norm)) + geom_col() "],["mix-vs-isolates.html", "Chapter 3 Mix vs isolates 3.1 Butyrivibrio fibrosolvens 3.2 Megasphaera elsdenii 3.3 Prevotella ruminicola 3.4 Eubacterium hallii", " Chapter 3 Mix vs isolates 3.1 Butyrivibrio fibrosolvens gene_counts_pair &lt;- gene_counts %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;)) %&gt;% mutate(sample = case_when( sample == &quot;C300216&quot; ~ &quot;mix&quot;, sample == &quot;C300205&quot; ~ &quot;isolate&quot;, TRUE ~ sample # Retain other values as-is )) %&gt;% filter(str_detect(gene, &quot;butyrivibrio_fibrisolvens&quot;)) %&gt;% group_by(sample) %&gt;% mutate(total=sum(norm)) %&gt;% rowwise() %&gt;% mutate(norm=norm/total) %&gt;% select(gene,sample,norm) %&gt;% pivot_wider(names_from = sample, values_from = norm) %&gt;% filter(if_all(everything(), ~ . != 0)) %&gt;% left_join(gene_annotations,by=&quot;gene&quot;) # Top overexpression in mixture gene_counts_pair %&gt;% mutate(difference_abs = mix-isolate) %&gt;% mutate(difference_rel = mix/isolate) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idw76jh4uv2e0uiepoysi5, .table th.tinytable_css_idw76jh4uv2e0uiepoysi5 { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_butyrivibrio_fibrisolvens@contig_00000037_67 0.7052938502 4.329083e-04 0.7048609419 1629.19919 K02406 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000033_17 0.0024012828 3.097046e-05 0.0023703123 77.53461 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000037_66 0.0008265688 1.461691e-05 0.0008119519 56.54879 K02406 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000028_53 0.0006425085 1.152427e-05 0.0006309842 55.75264 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000033_79 0.0145925517 3.026647e-04 0.0142898870 48.21360 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000037_78 0.0014456725 3.045742e-05 0.0014152151 47.46537 K06603 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000056_28 0.0002936008 8.312696e-06 0.0002852881 35.31956 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000050_14 0.0004609468 1.354938e-05 0.0004473974 34.01978 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000050_13 0.0005671472 1.677535e-05 0.0005503719 33.80838 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000037_76 0.0011060703 3.284277e-05 0.0010732275 33.67774 K02422 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000053_217 0.0005798265 1.767723e-05 0.0005621493 32.80075 K03406 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000028_35 0.0046739552 1.460246e-04 0.0045279306 32.00799 K02398 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000049_52 0.0001966128 6.179690e-06 0.0001904331 31.81596 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000037_77 0.0012989235 4.261624e-05 0.0012563073 30.47955 K02407 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000052_120 0.0009648522 3.299398e-05 0.0009318582 29.24328 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000040_13 0.0005836368 2.003072e-05 0.0005636061 29.13709 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000067_38 0.0001924399 6.641455e-06 0.0001857984 28.97556 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000067_39 0.0002319871 8.745637e-06 0.0002232415 26.52604 K05349 GH3 BGU:bin_butyrivibrio_fibrisolvens@contig_00000014_9 0.0009204050 3.601178e-05 0.0008843932 25.55844 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000056_29 0.0003140581 1.315279e-05 0.0003009053 23.87767 K03406 NA # Top overexpression in isolate gene_counts_pair %&gt;% mutate(difference_abs = isolate-mix) %&gt;% mutate(difference_rel = isolate/mix) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_id0cts7614xy2le6i7rjha, .table th.tinytable_css_id0cts7614xy2le6i7rjha { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_butyrivibrio_fibrisolvens@contig_00000043_72 1.519722e-06 0.0053974481 0.0053959283 3551.6032 K07979 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000043_73 3.046637e-06 0.0063978755 0.0063948289 2099.9795 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000051_32 4.799121e-07 0.0007334945 0.0007330146 1528.3936 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000054_79 5.816307e-06 0.0084659446 0.0084601283 1455.5532 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000043_74 6.275281e-06 0.0069390831 0.0069328078 1105.7804 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000040_107 4.367270e-07 0.0004143453 0.0004139086 948.7514 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000018_17 5.328248e-05 0.0430758303 0.0430225478 808.4426 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000018_14 7.314471e-06 0.0053129384 0.0053056239 726.3599 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000051_33 6.631512e-06 0.0043374036 0.0043307720 654.0595 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000073_9 2.012782e-06 0.0011490985 0.0011470858 570.9007 K17686 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000018_16 4.760493e-05 0.0254866005 0.0254389956 535.3773 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000033_103 1.570872e-05 0.0083229538 0.0083072451 529.8303 K03705 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000018_13 1.906875e-06 0.0010081287 0.0010062218 528.6810 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000051_36 8.741146e-06 0.0045598849 0.0045511438 521.6576 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000049_85 6.860576e-07 0.0003482770 0.0003475909 507.6497 K02003 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000045_350 2.612884e-06 0.0011896757 0.0011870628 455.3113 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000045_352 7.047472e-06 0.0029963632 0.0029893157 425.1685 K13038 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000052_59 1.351582e-06 0.0005541440 0.0005527924 409.9965 NA NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000018_12 1.038551e-05 0.0042474916 0.0042371061 408.9826 K03205 NA BGU:bin_butyrivibrio_fibrisolvens@contig_00000051_34 8.886080e-06 0.0035683069 0.0035594208 401.5614 NA NA 3.2 Megasphaera elsdenii gene_counts_pair &lt;- gene_counts %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300212&quot;)) %&gt;% mutate(sample = case_when( sample == &quot;C300216&quot; ~ &quot;mix&quot;, sample == &quot;C300212&quot; ~ &quot;isolate&quot;, TRUE ~ sample # Retain other values as-is )) %&gt;% filter(str_detect(gene, &quot;megasphaera_elsdenii&quot;)) %&gt;% group_by(sample) %&gt;% mutate(total=sum(norm)) %&gt;% rowwise() %&gt;% mutate(norm=norm/total) %&gt;% select(gene,sample,norm) %&gt;% pivot_wider(names_from = sample, values_from = norm) %&gt;% filter(if_all(everything(), ~ . != 0)) %&gt;% left_join(gene_annotations,by=&quot;gene&quot;) # Top overexpression in mixture gene_counts_pair %&gt;% mutate(difference_abs = mix-isolate) %&gt;% mutate(difference_rel = mix/isolate) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idc2lcjbgqvviyk31y842o, .table th.tinytable_css_idc2lcjbgqvviyk31y842o { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_megasphaera_elsdenii@contig_00000001_360 8.893070e-04 3.060005e-06 8.862470e-04 290.62278 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_600 4.909868e-04 2.475855e-06 4.885110e-04 198.31002 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_359 1.053214e-03 6.909973e-06 1.046304e-03 152.41938 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_249 9.545405e-02 2.352885e-03 9.310116e-02 40.56894 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_355 5.207937e-05 1.386369e-06 5.069300e-05 37.56531 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1884 1.281915e-03 3.477799e-05 1.247137e-03 36.85994 K06155 NA BGU:bin_megasphaera_elsdenii@contig_00000001_1885 1.020638e-03 2.793697e-05 9.927015e-04 36.53362 K00033 NA BGU:bin_megasphaera_elsdenii@contig_00000001_1886 8.872374e-04 2.540948e-05 8.618279e-04 34.91757 K25031 NA BGU:bin_megasphaera_elsdenii@contig_00000001_258 4.219345e-03 1.260702e-04 4.093275e-03 33.46823 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_260 8.031939e-03 2.677764e-04 7.764162e-03 29.99495 K03737 NA BGU:bin_megasphaera_elsdenii@contig_00000001_353 5.082868e-05 1.723927e-06 4.910475e-05 29.48424 K03092 NA BGU:bin_megasphaera_elsdenii@contig_00000001_259 4.454091e-04 1.526530e-05 4.301438e-04 29.17788 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_354 5.288319e-05 1.898439e-06 5.098475e-05 27.85614 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_341 1.985974e-04 7.349192e-06 1.912482e-04 27.02302 K00005 NA BGU:bin_megasphaera_elsdenii@contig_00000001_356 9.237268e-05 3.650070e-06 8.872261e-05 25.30709 K00046 NA BGU:bin_megasphaera_elsdenii@contig_00000001_362 7.986347e-04 3.189355e-05 7.667411e-04 25.04063 K09022 NA BGU:bin_megasphaera_elsdenii@contig_00000001_358 6.178649e-05 2.835741e-06 5.895074e-05 21.78848 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_599 3.810911e-04 1.765959e-05 3.634315e-04 21.57984 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_342 1.577969e-03 7.794144e-05 1.500028e-03 20.24557 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_608 1.537391e-04 8.117939e-06 1.456212e-04 18.93820 NA NA # Top overexpression in isolate gene_counts_pair %&gt;% mutate(difference_abs = isolate-mix) %&gt;% mutate(difference_rel = isolate/mix) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idzestba7ucoox7os125ai, .table th.tinytable_css_idzestba7ucoox7os125ai { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_megasphaera_elsdenii@contig_00000001_299 1.652065e-05 0.0047260276 4.709507e-03 286.06791 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_337 1.723603e-04 0.0143546354 1.418228e-02 83.28270 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1955 9.857505e-07 0.0000720155 7.102975e-05 73.05652 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_2190 1.177675e-05 0.0007919906 7.802138e-04 67.25037 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1482 4.092772e-05 0.0025649923 2.524065e-03 62.67127 K12950 NA BGU:bin_megasphaera_elsdenii@contig_00000001_1973 1.138457e-05 0.0005894844 5.780999e-04 51.77924 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1970 1.119323e-05 0.0005645780 5.533847e-04 50.43922 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_2189 2.079123e-05 0.0009921252 9.713340e-04 47.71845 K00606 NA BGU:bin_megasphaera_elsdenii@contig_00000001_16 3.629448e-05 0.0017312036 1.694909e-03 47.69881 K03310 NA BGU:bin_megasphaera_elsdenii@contig_00000001_1971 7.787429e-06 0.0003684067 3.606193e-04 47.30788 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1485 4.410211e-05 0.0020364166 1.992314e-03 46.17504 K04759 NA BGU:bin_megasphaera_elsdenii@contig_00000001_1963 2.530300e-05 0.0010521956 1.026893e-03 41.58382 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1486 4.819787e-05 0.0019172443 1.869046e-03 39.77861 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1966 2.835229e-05 0.0010707177 1.042365e-03 37.76477 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1962 7.512918e-06 0.0002821988 2.746859e-04 37.56181 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1964 3.682185e-05 0.0012287189 1.191897e-03 33.36929 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1965 2.808106e-05 0.0009181134 8.900323e-04 32.69511 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1967 1.056659e-05 0.0003339676 3.234010e-04 31.60601 NA NA BGU:bin_megasphaera_elsdenii@contig_00000001_1959 1.532658e-05 0.0004795014 4.641748e-04 31.28562 K21636 NA BGU:bin_megasphaera_elsdenii@contig_00000001_1484 2.359327e-05 0.0007137156 6.901223e-04 30.25081 K04758 NA 3.3 Prevotella ruminicola gene_counts_pair &lt;- gene_counts %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300214&quot;)) %&gt;% mutate(sample = case_when( sample == &quot;C300216&quot; ~ &quot;mix&quot;, sample == &quot;C300214&quot; ~ &quot;isolate&quot;, TRUE ~ sample # Retain other values as-is )) %&gt;% filter(str_detect(gene, &quot;prevotella_ruminicola&quot;)) %&gt;% group_by(sample) %&gt;% mutate(total=sum(norm)) %&gt;% rowwise() %&gt;% mutate(norm=norm/total) %&gt;% select(gene,sample,norm) %&gt;% pivot_wider(names_from = sample, values_from = norm) %&gt;% filter(if_all(everything(), ~ . != 0)) %&gt;% left_join(gene_annotations,by=&quot;gene&quot;) # Top overexpression in mixture gene_counts_pair %&gt;% mutate(difference_abs = mix-isolate) %&gt;% mutate(difference_rel = mix/isolate) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idwgm52k8wocynlzx4wodm, .table th.tinytable_css_idwgm52k8wocynlzx4wodm { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_prevotella_ruminicola@contig_00000007_53 4.160456e-03 3.185536e-05 4.128600e-03 130.60459 NA NA BGU:bin_prevotella_ruminicola@contig_00000004_430 1.006387e-02 9.644014e-05 9.967429e-03 104.35353 NA NA BGU:bin_prevotella_ruminicola@contig_00000007_28 5.817006e-03 8.425197e-05 5.732754e-03 69.04297 NA NA BGU:bin_prevotella_ruminicola@contig_00000004_218 1.280322e-03 1.860197e-05 1.261720e-03 68.82721 NA NA BGU:bin_prevotella_ruminicola@contig_00000004_513 4.249413e-04 6.645279e-06 4.182960e-04 63.94634 K21572 NA BGU:bin_prevotella_ruminicola@contig_00000003_1427 4.810042e-03 9.300680e-05 4.717035e-03 51.71710 NA NA BGU:bin_prevotella_ruminicola@contig_00000006_113 4.537731e-04 8.939805e-06 4.448333e-04 50.75872 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_458 1.194715e-03 2.787900e-05 1.166836e-03 42.85357 K00343 NA BGU:bin_prevotella_ruminicola@contig_00000006_115 8.294711e-04 1.991971e-05 8.095514e-04 41.64071 NA NA BGU:bin_prevotella_ruminicola@contig_00000004_278 5.305952e-04 1.285894e-05 5.177363e-04 41.26276 K21572 NA BGU:bin_prevotella_ruminicola@contig_00000004_279 7.051714e-04 1.715538e-05 6.880160e-04 41.10498 K21573 NA BGU:bin_prevotella_ruminicola@contig_00000006_114 5.651025e-04 1.397607e-05 5.511264e-04 40.43357 NA NA BGU:bin_prevotella_ruminicola@contig_00000004_514 2.508457e-04 6.877173e-06 2.439685e-04 36.47511 K21573 NA BGU:bin_prevotella_ruminicola@contig_00000003_457 1.132016e-03 3.126642e-05 1.100749e-03 36.20549 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_848 6.879163e-03 2.082989e-04 6.670864e-03 33.02544 NA NA BGU:bin_prevotella_ruminicola@contig_00000007_29 8.955745e-04 2.780705e-05 8.677675e-04 32.20674 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_455 4.112099e-04 1.343751e-05 3.977724e-04 30.60163 K00340 NA BGU:bin_prevotella_ruminicola@contig_00000003_456 9.383332e-04 3.137611e-05 9.069571e-04 29.90598 K00341 NA BGU:bin_prevotella_ruminicola@contig_00000004_508 3.702491e-04 1.279447e-05 3.574546e-04 28.93820 K21572 NA BGU:bin_prevotella_ruminicola@contig_00000009_11 7.680573e-05 2.841483e-06 7.396425e-05 27.03015 NA NA # Top overexpression in isolate gene_counts_pair %&gt;% mutate(difference_abs = isolate-mix) %&gt;% mutate(difference_rel = isolate/mix) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idimcwx4r3uyk5ayh8ewdo, .table th.tinytable_css_idimcwx4r3uyk5ayh8ewdo { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_prevotella_ruminicola@contig_00000003_950 2.910369e-05 0.0100303649 0.0100012612 344.64236 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_949 2.664009e-05 0.0065987042 0.0065720641 247.69827 NA NA BGU:bin_prevotella_ruminicola@contig_00000007_107 3.347942e-06 0.0001816949 0.0001783470 54.27063 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_951 3.886004e-05 0.0016733483 0.0016344883 43.06090 K11921 NA BGU:bin_prevotella_ruminicola@contig_00000007_22 2.484313e-05 0.0008585299 0.0008336867 34.55804 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_948 5.031332e-05 0.0015067797 0.0014564663 29.94793 K03324 NA BGU:bin_prevotella_ruminicola@contig_00000004_600 6.479117e-05 0.0016817496 0.0016169584 25.95646 NA NA BGU:bin_prevotella_ruminicola@contig_00000004_194 1.966510e-04 0.0048346211 0.0046379701 24.58478 K00705 GH77 BGU:bin_prevotella_ruminicola@contig_00000004_267 2.702977e-04 0.0065137545 0.0062434568 24.09844 K21573 NA BGU:bin_prevotella_ruminicola@contig_00000007_21 3.708419e-04 0.0086477126 0.0082768707 23.31913 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_3 1.122545e-04 0.0025450453 0.0024327908 22.67209 NA NA BGU:bin_prevotella_ruminicola@contig_00000004_263 9.896068e-05 0.0021333049 0.0020343442 21.55710 NA GH13; GH13_14; GH13_1; GH13_32; GH13_36; GH13_5; GH13_6; GH13_7 BGU:bin_prevotella_ruminicola@contig_00000003_1329 5.796320e-05 0.0012025985 0.0011446353 20.74762 K07107 NA BGU:bin_prevotella_ruminicola@contig_00000003_516 1.167447e-04 0.0024119272 0.0022951825 20.65984 K03321 NA BGU:bin_prevotella_ruminicola@contig_00000007_115 8.000597e-06 0.0001630469 0.0001550463 20.37934 NA NA BGU:bin_prevotella_ruminicola@contig_00000008_110 5.351667e-05 0.0010632660 0.0010097493 19.86794 K00941 NA BGU:bin_prevotella_ruminicola@contig_00000008_109 1.906146e-03 0.0359688072 0.0340626616 18.86992 NA NA BGU:bin_prevotella_ruminicola@contig_00000008_111 3.735204e-05 0.0006521646 0.0006148126 17.45995 NA NA BGU:bin_prevotella_ruminicola@contig_00000003_221 8.664811e-05 0.0014940439 0.0014073958 17.24266 K00764 NA BGU:bin_prevotella_ruminicola@contig_00000004_737 5.055259e-05 0.0008614168 0.0008108642 17.04001 K21573 NA 3.4 Eubacterium hallii gene_counts_pair &lt;- gene_counts %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300203&quot;)) %&gt;% mutate(sample = case_when( sample == &quot;C300216&quot; ~ &quot;mix&quot;, sample == &quot;C300203&quot; ~ &quot;isolate&quot;, TRUE ~ sample # Retain other values as-is )) %&gt;% filter(str_detect(gene, &quot;anaerobutyricum_hallii&quot;)) %&gt;% group_by(sample) %&gt;% mutate(total=sum(norm)) %&gt;% rowwise() %&gt;% mutate(norm=norm/total) %&gt;% select(gene,sample,norm) %&gt;% pivot_wider(names_from = sample, values_from = norm) %&gt;% filter(if_all(everything(), ~ . != 0)) %&gt;% left_join(gene_annotations,by=&quot;gene&quot;) # Top overexpression in mixture gene_counts_pair %&gt;% mutate(difference_abs = mix-isolate) %&gt;% mutate(difference_rel = mix/isolate) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idm2mawh4v1rrd2jnjw1vv, .table th.tinytable_css_idm2mawh4v1rrd2jnjw1vv { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_anaerobutyricum_hallii@contig_00000112_1 1.250096e-04 7.027727e-07 1.243068e-04 177.88056 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000079_8 2.015761e-03 2.428601e-05 1.991475e-03 83.00090 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000129_41 3.754574e-04 4.651418e-06 3.708060e-04 80.71891 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000147_18 3.303421e-04 4.178477e-06 3.261637e-04 79.05803 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000147_19 5.490723e-04 7.418875e-06 5.416534e-04 74.01018 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000147_23 1.694403e-04 2.301564e-06 1.671387e-04 73.61962 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000165_10 5.132565e-05 8.752380e-07 5.045042e-05 58.64194 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000165_9 6.628839e-05 1.159376e-06 6.512901e-05 57.17589 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000147_14 9.881130e-05 1.735167e-06 9.707613e-05 56.94627 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000147_25 1.080290e-04 2.041528e-06 1.059874e-04 52.91573 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000125_8 2.425436e-05 4.772317e-07 2.377712e-05 50.82302 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000147_40 9.338622e-05 1.861979e-06 9.152424e-05 50.15429 K06133 NA BGU:bin_anaerobutyricum_hallii@contig_00000134_20 1.673161e-04 3.337857e-06 1.639783e-04 50.12681 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000112_180 9.778727e-03 1.956528e-04 9.583074e-03 49.97999 K04759 NA BGU:bin_anaerobutyricum_hallii@contig_00000147_69 1.646743e-04 3.330156e-06 1.613442e-04 49.44942 K07171 NA BGU:bin_anaerobutyricum_hallii@contig_00000147_21 2.082789e-04 4.249904e-06 2.040290e-04 49.00791 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000151_7 7.271475e-05 1.567006e-06 7.114775e-05 46.40362 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000147_29 9.935044e-05 2.256797e-06 9.709364e-05 44.02275 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000094_1 6.801765e-05 1.605988e-06 6.641166e-05 42.35251 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000020_3 2.256355e-04 5.426216e-06 2.202093e-04 41.58247 NA NA # Top overexpression in isolate gene_counts_pair %&gt;% mutate(difference_abs = isolate-mix) %&gt;% mutate(difference_rel = isolate/mix) %&gt;% select(gene,mix,isolate,difference_abs,difference_rel,ko_id,cazy_ids) %&gt;% arrange(-difference_rel) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idlthd4wmcgws4ajl7wl44, .table th.tinytable_css_idlthd4wmcgws4ajl7wl44 { border-bottom: solid 0.1em #d3d8dc; } gene mix isolate difference_abs difference_rel ko_id cazy_ids BGU:bin_anaerobutyricum_hallii@contig_00000045_7 1.203389e-04 7.888811e-03 7.768472e-03 65.55494 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000045_8 6.772320e-05 3.000103e-03 2.932380e-03 44.29948 K08600 NA BGU:bin_anaerobutyricum_hallii@contig_00000008_9 8.465400e-06 3.550638e-04 3.465984e-04 41.94294 K03671 NA BGU:bin_anaerobutyricum_hallii@contig_00000112_75 3.735449e-06 1.516533e-04 1.479178e-04 40.59840 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000048_1 1.995416e-05 7.683147e-04 7.483605e-04 38.50399 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000107_38 1.707867e-05 6.054356e-04 5.883570e-04 35.44982 K07738 NA BGU:bin_anaerobutyricum_hallii@contig_00000087_17 1.749895e-05 5.425201e-04 5.250212e-04 31.00301 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000025_3 1.683077e-04 4.754005e-03 4.585697e-03 28.24591 K07301 NA BGU:bin_anaerobutyricum_hallii@contig_00000112_91 1.215287e-04 3.429725e-03 3.308197e-03 28.22152 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000120_6 3.661999e-05 9.648984e-04 9.282784e-04 26.34895 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000132_16 3.122567e-06 8.195073e-05 7.882817e-05 26.24467 K06409 NA BGU:bin_anaerobutyricum_hallii@contig_00000070_9 1.884515e-04 4.703500e-03 4.515048e-03 24.95867 K20109 NA BGU:bin_anaerobutyricum_hallii@contig_00000083_11 1.717240e-04 3.948070e-03 3.776346e-03 22.99079 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000129_32 2.459758e-04 5.625680e-03 5.379704e-03 22.87087 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000154_9 2.862067e-05 6.371598e-04 6.085391e-04 22.26222 K01567 CE4 BGU:bin_anaerobutyricum_hallii@contig_00000099_1 5.506533e-06 1.196876e-04 1.141810e-04 21.73556 NA NA BGU:bin_anaerobutyricum_hallii@contig_00000076_5 4.912894e-05 1.031503e-03 9.823740e-04 20.99583 K00059 NA BGU:bin_anaerobutyricum_hallii@contig_00000154_10 9.572414e-05 1.999748e-03 1.904023e-03 20.89073 K23242 NA BGU:bin_anaerobutyricum_hallii@contig_00000164_2 3.346648e-04 6.523208e-03 6.188543e-03 19.49176 K00973 NA BGU:bin_anaerobutyricum_hallii@contig_00000045_9 7.622274e-05 1.405231e-03 1.329008e-03 18.43585 NA NA "],["gene-selection.html", "Chapter 4 Gene selection 4.1 Expression-based 4.2 Sample-type based 4.3 Biology-based", " Chapter 4 Gene selection 4.1 Expression-based ko_counts &lt;- gene_counts %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% left_join(gene_annotations,by=&quot;gene&quot;) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(rel), genes=length(rel), prevalence=n_distinct(sample)-1) %&gt;% arrange(-count) 4.1.1 Around 1% ko_counts %&gt;% filter(count&gt;0.005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length),genes=length(count),prevalence=mean(prevalence)) %&gt;% arrange(-length) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idw2h47ajel8lp3bh4pm1v, .table th.tinytable_css_idw2h47ajel8lp3bh4pm1v { border-bottom: solid 0.1em #d3d8dc; } ko_id count length genes prevalence K02406 0.020174408 8031 1 2 K00074 0.008924697 1660 1 2 K06284 0.008297052 266 1 1 ko_counts %&gt;% filter(count&gt;0.005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length),genes=length(count),prevalence=mean(prevalence)) %&gt;% arrange(length) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idfgruar0msrate8gil15p, .table th.tinytable_css_idfgruar0msrate8gil15p { border-bottom: solid 0.1em #d3d8dc; } ko_id count length genes prevalence K06284 0.008297052 266 1 1 K00074 0.008924697 1660 1 2 K02406 0.020174408 8031 1 2 4.1.2 Around 0.1% ko_counts %&gt;% filter(count&lt;0.001, count&gt;0.0005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length),genes=length(count),prevalence=mean(prevalence)) %&gt;% arrange(-length) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idjqquolldnps9eucskhgu, .table th.tinytable_css_idjqquolldnps9eucskhgu { border-bottom: solid 0.1em #d3d8dc; } ko_id count length genes prevalence K03737 0.0009665096 21222 1 4 K02355 0.0007443959 16813 1 4 K03043 0.0005352638 15350 1 4 K00962 0.0005396617 8717 1 4 K04079 0.0008210985 8126 1 4 K21449 0.0008800172 7155 1 2 K00248 0.0008326408 6903 1 3 K03205 0.0006142626 6665 1 2 K01624 0.0006281923 6371 1 4 K18682 0.0005888945 6185 1 4 K00088 0.0006311325 5846 1 4 K03527 0.0005869425 5576 1 4 K01755 0.0005666887 5534 1 4 K03076 0.0006779553 5165 1 4 K08483 0.0006401731 5046 1 3 K01940 0.0006950669 4940 1 4 K00927 0.0005510772 4901 1 4 K13038 0.0005184668 4844 1 4 K03686 0.0005845309 4772 1 4 K00973 0.0008028390 4336 1 4 ko_counts %&gt;% filter(count&lt;0.001, count&gt;0.0005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length),genes=length(count),prevalence=mean(prevalence)) %&gt;% arrange(length) %&gt;% slice_head(n = 30) %&gt;% tt() .table td.tinytable_css_idkgcvu0yr87bdiyxivtb1, .table th.tinytable_css_idkgcvu0yr87bdiyxivtb1 { border-bottom: solid 0.1em #d3d8dc; } ko_id count length genes prevalence K02919 0.0007346037 342 1 3 K02418 0.0005463598 344 1 1 K06726 0.0006060981 395 1 1 K02913 0.0005780435 489 1 3 K19158 0.0005839305 517 1 3 K02399 0.0007741089 518 1 2 K03768 0.0005543181 521 1 1 K02911 0.0006201178 552 1 3 K05795 0.0006476264 557 1 1 K02902 0.0007542165 633 1 3 K06412 0.0007229159 643 1 2 K02909 0.0007624964 699 1 3 K02916 0.0005581532 719 1 4 K06890 0.0005752360 719 1 1 K02598 0.0006785917 767 1 1 K02968 0.0005403732 780 1 3 K16951 0.0006589310 812 1 1 K11921 0.0008374234 896 1 1 K03415 0.0005250373 905 1 1 K00852 0.0008528857 923 1 1 K01425 0.0005934176 932 1 1 K09973 0.0005341050 935 1 1 K02954 0.0006878270 941 1 4 K02961 0.0009460076 1019 1 4 K16950 0.0006156025 1019 1 1 K09787 0.0005140013 1035 1 3 K02965 0.0007797672 1040 1 4 K02956 0.0008528488 1067 1 4 K03412 0.0005322631 1085 1 1 K07473 0.0005946444 1108 1 3 4.1.3 Around 0.01% ko_counts %&gt;% filter(count&lt;0.0001, count&gt;0.00005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length),genes=length(count),prevalence=mean(prevalence)) %&gt;% arrange(-length) %&gt;% slice_head(n = 50) %&gt;% tt() .table td.tinytable_css_idxq26ex1y789yk5wdd3lv, .table th.tinytable_css_idxq26ex1y789yk5wdd3lv { border-bottom: solid 0.1em #d3d8dc; } ko_id count length genes prevalence K05349 5.862641e-05 53930 1 3 K03327 7.503624e-05 50741 1 4 K02004 6.728394e-05 38494 1 4 K19693 5.911606e-05 31810 1 1 K01190 6.817578e-05 30454 1 3 K03466 5.867466e-05 24401 1 4 K07315 8.483727e-05 24126 1 2 K07133 5.742709e-05 21634 1 2 K02014 8.948256e-05 19776 1 2 K01209 7.002415e-05 19080 1 2 K01955 9.207635e-05 16102 1 4 K03169 5.773327e-05 14873 1 4 K02337 7.390030e-05 14183 1 4 K03723 5.994050e-05 13727 1 4 K01652 9.649758e-05 13519 1 4 K07258 9.006087e-05 12985 1 4 K01740 7.517273e-05 12950 1 4 K03763 6.402364e-05 12819 1 3 K02238 8.552194e-05 12292 1 4 K03320 5.215735e-05 11917 1 4 K07052 7.646994e-05 11887 1 3 K01872 9.459962e-05 11725 1 4 K06926 9.388666e-05 11583 1 4 K01448 6.937049e-05 11556 1 4 K03215 8.100302e-05 11482 1 4 K16898 5.727290e-05 11253 1 3 K03529 5.229741e-05 10674 1 3 K02495 6.415541e-05 10630 1 4 K03555 9.369751e-05 10559 1 4 K03427 7.310218e-05 10410 1 4 K01208 6.124514e-05 10324 1 2 K01207 5.749597e-05 10211 1 4 K00548 5.939311e-05 10118 1 4 K07263 9.804701e-05 9875 1 1 K01890 8.431682e-05 9734 1 4 K08303 8.688225e-05 9711 1 3 K03308 8.448954e-05 9566 1 3 K06871 5.016399e-05 9557 1 4 K03546 8.957946e-05 9384 1 3 K07706 7.478543e-05 9280 1 2 K03497 5.527541e-05 9278 1 4 K03797 8.725877e-05 9141 1 4 K00864 7.217924e-05 9015 1 3 K09800 9.554443e-05 8959 1 2 K06959 6.165807e-05 8948 1 4 K17320 9.390336e-05 8430 1 1 K03572 8.282645e-05 8399 1 4 K03655 5.915904e-05 8207 1 4 K02483 9.528943e-05 8193 1 3 K06409 9.724046e-05 8089 1 3 ko_counts %&gt;% filter(count&lt;0.0001, count&gt;0.00005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length),genes=length(count),prevalence=mean(prevalence)) %&gt;% arrange(length) %&gt;% slice_head(n = 140) %&gt;% tt() .table td.tinytable_css_idmq1fs1ioaqww2o4v4nk0, .table th.tinytable_css_idmq1fs1ioaqww2o4v4nk0 { border-bottom: solid 0.1em #d3d8dc; } ko_id count length genes prevalence K06421 5.810491e-05 221 1 1 K06218 5.427337e-05 224 1 1 K14188 5.121486e-05 233 1 1 K02420 8.058133e-05 269 1 1 K06891 9.520758e-05 305 1 1 K07343 6.388063e-05 320 1 1 K21903 6.761812e-05 359 1 1 K02781 6.920137e-05 362 1 1 K02437 6.382068e-05 380 1 1 K06199 5.523634e-05 380 1 1 K14091 9.189214e-05 386 1 1 K15539 5.807747e-05 404 1 1 K02426 5.544135e-05 425 1 1 K02388 8.241911e-05 449 1 1 K06405 8.705675e-05 449 1 1 K07441 6.898826e-05 461 1 1 K07068 7.473971e-05 464 1 1 K13920 6.655409e-05 494 1 1 K22247 6.187765e-05 500 1 1 K01975 6.145870e-05 512 1 1 K19055 6.134207e-05 518 1 1 K01494 8.250588e-05 527 1 1 K02825 7.246884e-05 533 1 1 K00177 5.644465e-05 545 1 1 K01419 5.828842e-05 551 1 1 K03608 6.506125e-05 553 1 2 K02783 5.816694e-05 554 1 1 K11719 9.836831e-05 554 1 1 K16924 9.116945e-05 554 1 1 K07461 7.119965e-05 556 1 2 K05873 7.854831e-05 560 1 1 K19130 5.589200e-05 566 1 1 K14089 7.685115e-05 572 1 1 K03634 5.451986e-05 581 1 1 K09951 8.171016e-05 583 1 2 K04564 5.952695e-05 584 1 2 K09803 6.159705e-05 586 1 2 K06317 8.257244e-05 607 1 2 K02226 6.091814e-05 614 1 1 K00350 7.275446e-05 626 1 1 K15915 7.738148e-05 626 1 1 K21908 6.099236e-05 647 1 1 K03814 6.450503e-05 650 1 1 K15256 5.678603e-05 650 1 1 K21929 7.907370e-05 662 1 1 K00348 6.569881e-05 668 1 1 K06940 5.425683e-05 686 1 1 K01788 6.188839e-05 695 1 1 K02379 8.322102e-05 716 1 1 K16905 6.213466e-05 722 1 1 K07171 7.592944e-05 727 1 1 K18928 6.836831e-05 737 1 1 K16906 5.691445e-05 740 1 1 K13075 8.356485e-05 746 1 1 K16066 5.003578e-05 755 1 1 K06167 9.027460e-05 761 1 1 K02348 5.662081e-05 775 1 2 K25147 7.467622e-05 791 1 1 K02795 5.296845e-05 800 1 1 K09816 9.761950e-05 818 1 1 K07045 7.637258e-05 824 1 1 K22300 6.157072e-05 832 1 2 K02535 9.576939e-05 833 1 1 K13653 9.992627e-05 839 1 1 K25089 8.899810e-05 842 1 1 K21478 8.741164e-05 854 1 1 K07164 5.416545e-05 857 1 1 K09116 8.669927e-05 866 1 1 K00020 5.191778e-05 869 1 1 K06934 5.469014e-05 874 1 2 K04518 6.198667e-05 878 1 1 K19337 6.180041e-05 878 1 1 K07574 9.254789e-05 879 1 3 K02557 5.960372e-05 890 1 1 K05786 6.165221e-05 893 1 1 K19334 7.659314e-05 910 1 2 K02796 5.485944e-05 914 1 1 K01066 5.110372e-05 920 1 1 K04562 9.448605e-05 932 1 1 K01749 5.832938e-05 935 1 1 K00737 9.011408e-05 953 1 2 K00847 7.123674e-05 959 1 1 K01802 7.602649e-05 959 1 1 K00683 6.523680e-05 989 1 1 K02794 6.445084e-05 989 1 1 K05794 8.119217e-05 989 1 1 K01993 6.250172e-05 992 1 1 K02031 7.139779e-05 992 1 1 K03711 8.887982e-05 997 1 2 K07027 5.959011e-05 1001 1 1 K09747 9.954731e-05 1008 1 3 K07304 8.165964e-05 1009 1 2 K02782 7.351042e-05 1010 1 1 K01599 5.441582e-05 1025 1 1 K19225 5.960620e-05 1031 1 1 K17202 7.976376e-05 1037 1 1 K09145 5.941757e-05 1045 1 1 K01269 5.509368e-05 1052 1 1 K03490 7.206750e-05 1055 1 1 K17609 8.428337e-05 1066 1 1 K13663 5.490057e-05 1076 1 1 K14090 8.673240e-05 1079 1 1 K19802 5.509925e-05 1094 1 1 K07148 7.890670e-05 1121 1 1 K00995 8.104252e-05 1126 1 2 K10811 9.156510e-05 1127 1 1 K00009 5.193346e-05 1142 1 1 K24258 7.617190e-05 1166 1 1 K01839 9.360599e-05 1172 1 1 K13684 5.900764e-05 1175 1 1 K01693 5.952128e-05 1177 1 2 K03469 8.251948e-05 1189 1 2 K01500 9.641162e-05 1222 1 2 K07181 7.245544e-05 1226 1 1 K15519 9.139380e-05 1234 1 1 K00876 7.856731e-05 1237 1 2 K01251 8.447278e-05 1241 1 1 K03623 6.342068e-05 1243 1 2 K03975 6.139746e-05 1252 1 2 K01487 8.266722e-05 1256 1 1 K07035 5.643293e-05 1259 1 1 K00351 6.213248e-05 1268 1 1 K08218 9.090759e-05 1268 1 1 K00756 8.601778e-05 1304 1 2 K04094 9.672877e-05 1325 1 1 K24206 6.374723e-05 1328 1 1 K12452 8.057881e-05 1337 1 1 K07791 8.080782e-05 1346 1 1 K25034 9.620229e-05 1352 1 1 K00949 7.219655e-05 1360 1 2 K09691 8.217810e-05 1373 1 1 K02404 9.703043e-05 1376 1 1 K03771 6.301071e-05 1379 1 1 K23775 6.435221e-05 1389 1 3 K00104 5.216373e-05 1403 1 1 K03667 6.317032e-05 1403 1 1 K18349 5.047754e-05 1405 1 1 K06382 7.311623e-05 1409 1 1 K00936 6.541397e-05 1412 1 1 K09125 9.588837e-05 1435 1 2 4.1.4 Around 0.001% ko_counts %&gt;% filter(count&lt;0.00001, count&gt;0.000005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length),genes=length(count),prevalence=mean(prevalence)) %&gt;% arrange(-length) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_id7wfplgr4edx3c62dkasz, .table th.tinytable_css_id7wfplgr4edx3c62dkasz { border-bottom: solid 0.1em #d3d8dc; } ko_id count length genes prevalence K15921 9.606348e-06 7694 1 2 K14698 5.547314e-06 7121 1 2 K22994 9.082507e-06 6269 1 1 K14699 7.021066e-06 5250 1 2 K08640 7.584329e-06 4843 1 1 K12063 7.093315e-06 4753 1 1 K00956 5.400768e-06 3343 1 2 K19088 9.508290e-06 3166 1 1 K03573 5.092321e-06 2938 1 1 K13020 8.657446e-06 2224 1 1 K10797 8.879633e-06 1991 1 1 K18197 5.491806e-06 1982 1 1 K26178 8.033022e-06 1946 1 1 K19090 6.946249e-06 1831 1 1 K21755 5.797391e-06 1804 1 2 K19075 8.644859e-06 1777 1 1 K06221 5.972027e-06 1660 1 1 K03332 6.720187e-06 1658 1 1 K02042 8.692602e-06 1547 1 1 K22704 7.790739e-06 1544 1 1 ko_counts %&gt;% filter(count&lt;0.00001, count&gt;0.000005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length),genes=length(count),prevalence=mean(prevalence)) %&gt;% arrange(length) %&gt;% slice_head(n = 40) %&gt;% tt() .table td.tinytable_css_idsu0w5zixoiovp5qc2mcl, .table th.tinytable_css_idsu0w5zixoiovp5qc2mcl { border-bottom: solid 0.1em #d3d8dc; } ko_id count length genes prevalence K04085 9.911774e-06 245 1 1 K07066 7.504858e-06 245 1 1 K09706 7.301857e-06 395 1 1 K18815 9.769260e-06 452 1 1 K00334 7.813230e-06 476 1 1 K06908 6.264604e-06 530 1 1 K01664 5.087318e-06 563 1 1 K16926 8.329515e-06 599 1 1 K10040 6.067934e-06 716 1 1 K02041 9.091439e-06 749 1 1 K20489 8.518532e-06 815 1 1 K07454 7.968659e-06 827 1 1 K02047 5.410098e-06 830 1 1 K25088 5.946171e-06 833 1 2 K02585 5.018397e-06 875 1 1 K21010 8.795119e-06 896 1 1 K03779 7.713142e-06 899 1 1 K10039 5.125699e-06 902 1 1 K11051 5.473787e-06 911 1 1 K23004 6.448007e-06 911 1 1 K13043 5.697234e-06 965 1 1 K01518 7.634070e-06 974 1 1 K01478 6.084301e-06 986 1 1 K02044 5.818278e-06 1031 1 1 K23163 8.505596e-06 1046 1 1 K16568 7.456303e-06 1079 1 1 K00549 6.526071e-06 1115 1 1 K13017 8.164579e-06 1130 1 1 K18677 6.925817e-06 1136 1 1 K07464 6.626420e-06 1162 1 2 K06905 5.038596e-06 1166 1 1 K01439 5.478600e-06 1211 1 1 K08177 8.622011e-06 1238 1 1 K06438 9.846247e-06 1253 1 1 K19956 9.741262e-06 1265 1 1 K04652 6.716443e-06 1348 1 1 K11104 8.456796e-06 1382 1 1 K07458 5.237589e-06 1395 1 2 K09792 6.224514e-06 1445 1 1 K20492 7.777973e-06 1471 1 2 4.1.5 Around 0.0001% ko_counts %&gt;% filter(count&lt;0.000001, count&gt;0.0000005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length),genes=length(count),prevalence=mean(prevalence)) %&gt;% arrange(-length) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_idhtl00kguk9i4va2b912k, .table th.tinytable_css_idhtl00kguk9i4va2b912k { border-bottom: solid 0.1em #d3d8dc; } ko_id count length genes prevalence K06390 7.200424e-07 962 1 1 K06396 8.969989e-07 572 1 1 K06395 6.490235e-07 527 1 1 K06392 8.898973e-07 269 1 0 ko_counts %&gt;% filter(count&lt;0.000001, count&gt;0.0000005) %&gt;% left_join(gene_annotations,by=&quot;ko_id&quot;) %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(ko_id) %&gt;% summarise(count=mean(count),length=sum(gene_length),genes=length(ko_id)) %&gt;% arrange(length) %&gt;% slice_head(n = 20) %&gt;% tt() .table td.tinytable_css_id55sz2ltvb552q7ssf638, .table th.tinytable_css_id55sz2ltvb552q7ssf638 { border-bottom: solid 0.1em #d3d8dc; } ko_id count length genes K06392 8.898973e-07 269 1 K06395 6.490235e-07 527 1 K06396 8.969989e-07 572 1 K06390 7.200424e-07 962 1 4.2 Sample-type based 4.2.1 Flagellum-related genes (K02406, K06603, K02422, K02398, K02407) Overexpressed by Butyrivibrio fibrosolvens in mixture compared to isolation gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K02406|K06603|K02422|K02398|K02407&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idwildo1jy7758ceo3fyd8, .table th.tinytable_css_idwildo1jy7758ceo3fyd8 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300205 Butyrivibrio fibrosolvens 12 12504 1042 0.001795491 C300216 Mix cultures 12 12504 1042 0.367649641 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K02406&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idm48342hvya9hulob8rj6, .table th.tinytable_css_idm48342hvya9hulob8rj6 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300205 Butyrivibrio fibrosolvens 6 8031 1338.5 0.0005360178 C300216 Mix cultures 6 8031 1338.5 0.3626026370 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K06603&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idtypubua1woabeyh3l8ec, .table th.tinytable_css_idtypubua1woabeyh3l8ec { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300205 Butyrivibrio fibrosolvens 1 488 488 0.0000304504 C300216 Mix cultures 1 488 488 0.0007419652 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K02398&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idqrj4yktou2ywntgountl, .table th.tinytable_css_idqrj4yktou2ywntgountl { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300205 Butyrivibrio fibrosolvens 1 266 266 0.000145991 C300216 Mix cultures 1 266 266 0.002398823 4.2.2 Chemotaxis (K03406) Overexpressed by Butyrivibrio fibrosolvens in mixture compared to isolation gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K03406&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idru7tsnt1k7fjewmocoz6, .table th.tinytable_css_idru7tsnt1k7fjewmocoz6 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300205 Butyrivibrio fibrosolvens 19 33260 1750.526 2.101638e-03 C300216 Mix cultures 19 33260 1750.526 2.721766e-03 C300203 Eubacterium hallii 3 5025 1675.000 8.021559e-08 4.2.3 Glycoside Hydrolase Family 3 (GH3:K05349) Overexpressed by Butyrivibrio fibrosolvens in mixture compared to isolation Overexpressed by Prevotella ruminicola in isolation compared to mixture gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, &quot;GH3&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idlgfl4bgyd790vooehttj, .table th.tinytable_css_idlgfl4bgyd790vooehttj { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 56 119974 2142.393 7.872583e-04 C300205 Butyrivibrio fibrosolvens 28 59642 2130.071 1.621008e-03 C300214 Prevotella ruminicola 26 57958 2229.154 3.704860e-03 C300203 Eubacterium hallii 2 4036 2018.000 2.476292e-05 C300212 Megasphaera elsdenii 1 1145 1145.000 1.432714e-04 4.2.4 Glycoside Hydrolase Family 77 (GH77:K00705) Overexpressed by Prevotella ruminicola in isolation compared to mixture gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, &quot;GH77&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_iday7i82kmqzr5wscjfewr, .table th.tinytable_css_iday7i82kmqzr5wscjfewr { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 6 13206 2201.0 0.0002215298 C300203 Eubacterium hallii 3 4521 1507.0 0.0006693800 C300214 Prevotella ruminicola 2 5287 2643.5 0.0049407398 C300205 Butyrivibrio fibrosolvens 1 1529 1529.0 0.0001782614 C300212 Megasphaera elsdenii 1 3398 3398.0 0.0001625837 4.2.5 Gluconate metabolism (K00033, K25031,K07979, K06155) Overexpressed by Butyrivibrio fibrosolvens in isolation compared to mixture Overexpressed by Megasphaera elsdenii in mixture compared to isolation gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K00033|K25031|K07979|K06155&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idm061zfah1xu490naj7i7, .table th.tinytable_css_idm061zfah1xu490naj7i7 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 6 5406 901 1.407192e-03 C300212 Megasphaera elsdenii 3 4290 1430 8.812393e-05 C300203 Eubacterium hallii 2 742 371 7.000805e-05 C300205 Butyrivibrio fibrosolvens 1 374 374 5.396205e-03 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K00033&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idvd4sz9n8yr0822q82lxf, .table th.tinytable_css_idvd4sz9n8yr0822q82lxf { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300212 Megasphaera elsdenii 1 1412 1412 0.0000279368 C300216 Mix cultures 1 1412 1412 0.0004497883 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K25031&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idy4cfb3zfn8sr3yod66by, .table th.tinytable_css_idy4cfb3zfn8sr3yod66by { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300212 Megasphaera elsdenii 1 1559 1559 2.540933e-05 C300216 Mix cultures 1 1559 1559 3.909994e-04 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K07979&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idnlua30hlbaku6on7a3qx, .table th.tinytable_css_idnlua30hlbaku6on7a3qx { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 3 1116 372 1.473743e-06 C300203 Eubacterium hallii 2 742 371 7.000805e-05 C300205 Butyrivibrio fibrosolvens 1 374 374 5.396205e-03 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K06155&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idowck4fg0y99tbbl77ama, .table th.tinytable_css_idowck4fg0y99tbbl77ama { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300212 Megasphaera elsdenii 1 1319 1319 3.477779e-05 C300216 Mix cultures 1 1319 1319 5.649309e-04 4.2.6 ABC transporter (K02003) Overexpressed by Butyrivibrio fibrosolvens in mixture compared to isolation gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K02003&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_id7bcclfb6vymr78untp30, .table th.tinytable_css_id7bcclfb6vymr78untp30 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 14 9934 709.5714 2.322676e-04 C300203 Eubacterium hallii 5 3535 707.0000 4.012481e-04 C300205 Butyrivibrio fibrosolvens 5 3547 709.4000 5.232606e-04 C300214 Prevotella ruminicola 3 2148 716.0000 4.277998e-03 C300212 Megasphaera elsdenii 1 704 704.0000 6.634069e-05 4.2.7 Manganese-transport (K12950) Overexpressed by Megasphaera elsdenii in isolation compared to mixture gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K12950&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idv4682c7r5rpg9bxb0n06, .table th.tinytable_css_idv4682c7r5rpg9bxb0n06 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300212 Megasphaera elsdenii 1 2093 2093 2.564977e-03 C300216 Mix cultures 1 2093 2093 1.803656e-05 4.2.8 Starch-binding (K21572, K21573) Overexpressed by Prevotella ruminicola in mixture compared to isolation gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K21572|K21573&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idpwmn6rkf0kpkf380a6v1, .table th.tinytable_css_idpwmn6rkf0kpkf380a6v1 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300214 Prevotella ruminicola 57 139737 2451.526 0.0209917750 C300216 Mix cultures 57 139737 2451.526 0.0005702295 4.2.9 Sortase (K08600) Overexpressed by Eubacterium hallii in isolation compared to mixture gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K08600&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_ids1ztxeuv977rtxz2kf13, .table th.tinytable_css_ids1ztxeuv977rtxz2kf13 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 7 5669 809.8571 9.064762e-05 C300203 Eubacterium hallii 4 3092 773.0000 3.485805e-03 C300205 Butyrivibrio fibrosolvens 3 2577 859.0000 2.594045e-04 4.2.10 Thioredoxin (K03671) Overexpressed by Eubacterium hallii in isolation compared to mixture gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K03671&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idzrdfl01z7g3ph99cwcqz, .table th.tinytable_css_idzrdfl01z7g3ph99cwcqz { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 8 2554 319.25 0.0024515593 C300203 Eubacterium hallii 4 1238 309.50 0.0006571063 C300212 Megasphaera elsdenii 2 691 345.50 0.0011983052 C300205 Butyrivibrio fibrosolvens 1 311 311.00 0.0015846910 C300214 Prevotella ruminicola 1 314 314.00 0.0047570508 4.3 Biology-based 4.3.1 Carbohydrate esterase 4 (CE4) gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, &quot;CE4&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idgotslzzofyb3glvsqjh9, .table th.tinytable_css_idgotslzzofyb3glvsqjh9 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 13 11813 908.6923 0.0004350060 C300203 Eubacterium hallii 5 5203 1040.6000 0.0016641151 C300205 Butyrivibrio fibrosolvens 4 4169 1042.2500 0.0012442383 C300212 Megasphaera elsdenii 3 2517 839.0000 0.0006045762 C300214 Prevotella ruminicola 2 1387 693.5000 0.0001697459 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K22278&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_iddme464su89173retpu3h, .table th.tinytable_css_iddme464su89173retpu3h { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 4 4130 1032.5 1.434492e-04 C300203 Eubacterium hallii 2 2617 1308.5 9.884610e-04 C300205 Butyrivibrio fibrosolvens 1 1463 1463.0 1.165219e-03 C300212 Megasphaera elsdenii 1 902 902.0 6.680495e-05 C300214 Prevotella ruminicola 1 611 611.0 6.252120e-05 4.3.2 Carbohydrate-Binding Module Family 48 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, &quot;CBM48&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idrdq67o9cg54z8jqz4sr2, .table th.tinytable_css_idrdq67o9cg54z8jqz4sr2 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 4 8747 2186.75 0.0002547720 C300203 Eubacterium hallii 2 4012 2006.00 0.0004183157 C300205 Butyrivibrio fibrosolvens 2 4735 2367.50 0.0009393852 C300212 Megasphaera elsdenii 1 2108 2108.00 0.0003326121 4.3.3 GlycosylTransferase Family 5 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, &quot;GT5&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idht79gd6apbd6d4hoktoi, .table th.tinytable_css_idht79gd6apbd6d4hoktoi { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 21 33279 1584.714 0.0009141823 C300203 Eubacterium hallii 7 13835 1976.429 0.0017463092 C300205 Butyrivibrio fibrosolvens 6 8661 1443.500 0.0012246034 C300214 Prevotella ruminicola 6 9246 1541.000 0.0024240719 C300212 Megasphaera elsdenii 3 4266 1422.000 0.0027234902 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K05366&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_id8dpchoaf60789jc9hnwa, .table th.tinytable_css_id8dpchoaf60789jc9hnwa { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 4 9779 2444.75 0.0001691930 C300203 Eubacterium hallii 2 5413 2706.50 0.0004614619 C300205 Butyrivibrio fibrosolvens 1 2729 2729.00 0.0006472702 C300212 Megasphaera elsdenii 1 2042 2042.00 0.0002596295 C300214 Prevotella ruminicola 1 2324 2324.00 0.0001147934 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K00703&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idc78q7vic53m90yhezb8o, .table th.tinytable_css_idc78q7vic53m90yhezb8o { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 5 7894 1578.8 0.0003570058 C300203 Eubacterium hallii 3 5013 1671.0 0.0007853023 C300205 Butyrivibrio fibrosolvens 1 1445 1445.0 0.0002996259 C300212 Megasphaera elsdenii 1 1436 1436.0 0.0004431815 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K18770&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idp86swolpfirb23trmk5v, .table th.tinytable_css_idp86swolpfirb23trmk5v { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300203 Eubacterium hallii 1 2336 2336 4.679609e-04 C300216 Mix cultures 1 2336 2336 1.403010e-06 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K03814&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_id09u5s3fesd90pc1qp92w, .table th.tinytable_css_id09u5s3fesd90pc1qp92w { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300214 Prevotella ruminicola 1 650 650 1.218823e-04 C300216 Mix cultures 1 650 650 7.127721e-06 4.3.4 GlycosylTransferase Family 2 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, &quot;GT2&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idd7qyeux8gtler3yngdxe, .table th.tinytable_css_idd7qyeux8gtler3yngdxe { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 88 92864 1055.273 0.001579766 C300205 Butyrivibrio fibrosolvens 45 49293 1095.400 0.004555735 C300214 Prevotella ruminicola 23 23773 1033.609 0.001977584 C300203 Eubacterium hallii 14 15085 1077.500 0.003859919 C300212 Megasphaera elsdenii 8 7747 968.375 0.001251049 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K16698&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idqf7ees0le9swt10yjuiu, .table th.tinytable_css_idqf7ees0le9swt10yjuiu { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 3 2301 767 7.321216e-05 C300203 Eubacterium hallii 1 767 767 4.650322e-05 C300205 Butyrivibrio fibrosolvens 1 782 782 4.157984e-05 C300212 Megasphaera elsdenii 1 752 752 2.161547e-05 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K02563&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idy86xm0t2s7mrfqnx6b0g, .table th.tinytable_css_idy86xm0t2s7mrfqnx6b0g { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 4 4394 1098.5 0.0001341443 C300203 Eubacterium hallii 1 1100 1100.0 0.0008688336 C300205 Butyrivibrio fibrosolvens 1 1070 1070.0 0.0002893365 C300212 Megasphaera elsdenii 1 1121 1121.0 0.0001877960 C300214 Prevotella ruminicola 1 1103 1103.0 0.0002487438 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K05946&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_iduwmuxubfwo9wi16a787n, .table th.tinytable_css_iduwmuxubfwo9wi16a787n { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 2 2194 1097 0.0002045733 C300205 Butyrivibrio fibrosolvens 1 1511 1511 0.0001269732 C300212 Megasphaera elsdenii 1 683 683 0.0003683999 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K03429&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idbj2ml5rikjwrytnzcv5p, .table th.tinytable_css_idbj2ml5rikjwrytnzcv5p { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300212 Megasphaera elsdenii 1 1145 1145 0.0002260239 C300216 Mix cultures 1 1145 1145 0.0001844515 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K00721&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_iddlzxy846z7r8r4dw6k64, .table th.tinytable_css_iddlzxy846z7r8r4dw6k64 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300214 Prevotella ruminicola 1 749 749 5.578771e-05 C300216 Mix cultures 1 749 749 2.290965e-06 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K12999&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_iddqqn6brq1s4alyguvefw, .table th.tinytable_css_iddqqn6brq1s4alyguvefw { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300205 Butyrivibrio fibrosolvens 1 932 932 3.718374e-04 C300216 Mix cultures 1 932 932 2.056542e-05 4.3.5 Glycoside Hydrolase Family 3 (GH3) gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, &quot;GH3&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_id4sriumt8ldvhuboczvuz, .table th.tinytable_css_id4sriumt8ldvhuboczvuz { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 56 119974 2142.393 7.872583e-04 C300205 Butyrivibrio fibrosolvens 28 59642 2130.071 1.621008e-03 C300214 Prevotella ruminicola 26 57958 2229.154 3.704860e-03 C300203 Eubacterium hallii 2 4036 2018.000 2.476292e-05 C300212 Megasphaera elsdenii 1 1145 1145.000 1.432714e-04 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K01207&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_id2rtmhuqrz820w5z10chw, .table th.tinytable_css_id2rtmhuqrz820w5z10chw { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 7 10211 1458.714 1.560594e-04 C300205 Butyrivibrio fibrosolvens 4 6662 1665.500 3.985768e-04 C300203 Eubacterium hallii 1 1229 1229.000 2.475074e-05 C300212 Megasphaera elsdenii 1 1145 1145.000 1.432714e-04 C300214 Prevotella ruminicola 1 1175 1175.000 1.397561e-04 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K01187&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_id1nw7lhfif6dtgpdugese, .table th.tinytable_css_id1nw7lhfif6dtgpdugese { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 2 4102 2051 2.113179e-05 C300205 Butyrivibrio fibrosolvens 1 1979 1979 3.771056e-05 C300214 Prevotella ruminicola 1 2123 2123 8.368746e-05 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K05349&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_iduj7b013p3nme63n92zp0, .table th.tinytable_css_iduj7b013p3nme63n92zp0 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 22 53930 2451.364 2.948646e-04 C300205 Butyrivibrio fibrosolvens 11 27409 2491.727 4.268812e-04 C300214 Prevotella ruminicola 11 26521 2411.000 1.975045e-03 C300203 Eubacterium hallii 1 2807 2807.000 1.218293e-08 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K01811&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idsixvajhis3hwfkw6rrnf, .table th.tinytable_css_idsixvajhis3hwfkw6rrnf { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 5 11950 2390 3.402121e-05 C300214 Prevotella ruminicola 3 7506 2502 1.859333e-04 C300205 Butyrivibrio fibrosolvens 2 4444 2222 9.591882e-05 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K01193&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_id11oakpg97f6vc4h98y5t, .table th.tinytable_css_id11oakpg97f6vc4h98y5t { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 2 3106 1553 3.398777e-06 C300205 Butyrivibrio fibrosolvens 1 1508 1508 3.813124e-05 C300214 Prevotella ruminicola 1 1598 1598 1.886623e-05 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K01191&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idslxwbauryawhl0c0n1eu, .table th.tinytable_css_idslxwbauryawhl0c0n1eu { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300214 Prevotella ruminicola 1 3581 3581 0.0006303326 C300216 Mix cultures 1 3581 3581 0.0001889107 4.3.6 Glycoside Hydrolase Family 77 Overexpressed by Prevotella ruminicola in isolation compared to mixture gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, &quot;GH77&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idpcymsagb2cfu8v8yweot, .table th.tinytable_css_idpcymsagb2cfu8v8yweot { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 6 13206 2201.0 0.0002215298 C300203 Eubacterium hallii 3 4521 1507.0 0.0006693800 C300214 Prevotella ruminicola 2 5287 2643.5 0.0049407398 C300205 Butyrivibrio fibrosolvens 1 1529 1529.0 0.0001782614 C300212 Megasphaera elsdenii 1 3398 3398.0 0.0001625837 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K00705&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_idsqmt8mcy2ytlgp35pjs1, .table th.tinytable_css_idsqmt8mcy2ytlgp35pjs1 { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 5 9808 1961.6 7.459488e-05 C300203 Eubacterium hallii 3 4521 1507.0 6.693800e-04 C300214 Prevotella ruminicola 2 5287 2643.5 4.940740e-03 C300205 Butyrivibrio fibrosolvens 1 1529 1529.0 1.782614e-04 gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(ko_id, &quot;K01208&quot;)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(gene_length=end_position-start_position) %&gt;% group_by(sample,Bacteria) %&gt;% summarise(genes=n(),length_total=sum(gene_length),length_mean=mean(gene_length),count_relative=sum(rel)) %&gt;% arrange(-genes) %&gt;% tt() .table td.tinytable_css_id56zomo5mjorpfcc9acex, .table th.tinytable_css_id56zomo5mjorpfcc9acex { border-bottom: solid 0.1em #d3d8dc; } sample Bacteria genes length_total length_mean count_relative C300216 Mix cultures 5 10324 2064.8 0.0001536602 C300205 Butyrivibrio fibrosolvens 4 6926 1731.5 0.0002962074 C300212 Megasphaera elsdenii 1 3398 3398.0 0.0001625837 "],["target-preparation.html", "Chapter 5 Target preparation 5.1 Expression-based 5.2 Differential expression 5.3 Biologically relevant 5.4 Run shell", " Chapter 5 Target preparation Target preparation for probe design generate_target &lt;- function(target, gene_annotations, gene_counts, sample_metadata) { gene_annotations %&gt;% filter(str_detect(genome, &quot;butyrivibrio_fibrisolvens|megasphaera_elsdenii|prevotella_ruminicola|anaerobutyricum_hallii&quot;)) %&gt;% filter(str_detect(cazy_ids, target) | str_detect(ko_id, target)) %&gt;% left_join(gene_counts,by=&quot;gene&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(sample %in% c(&quot;C300216&quot;,&quot;C300205&quot;,&quot;C300212&quot;,&quot;C300214&quot;,&quot;C300203&quot;)) %&gt;% filter(rel&gt;0) %&gt;% mutate(contig = str_replace(contig, &quot;BGU:&quot;, &quot;BGU_&quot;)) %&gt;% select(contig,start_position,end_position) %&gt;% mutate(score=&quot;.&quot;, strand=&quot;+&quot;, frame=&quot;.&quot;, attribute=&quot;.&quot;) %&gt;% unique() %&gt;% write_tsv(str_c(&quot;targets/&quot;,target,&quot;.gtf&quot;), col_names=FALSE) } 5.1 Expression-based #Around 1% generate_target(&quot;K00626&quot;, gene_annotations, gene_counts, sample_metadata) generate_target(&quot;K01007&quot;, gene_annotations, gene_counts, sample_metadata) generate_target(&quot;K00074&quot;, gene_annotations, gene_counts, sample_metadata) #Around 0.1% generate_target(&quot;K03798&quot;, gene_annotations, gene_counts, sample_metadata) generate_target(&quot;K04759&quot;, gene_annotations, gene_counts, sample_metadata) generate_target(&quot;K01951&quot;, gene_annotations, gene_counts, sample_metadata) #Around 0.01% generate_target(&quot;K07133&quot;, gene_annotations, gene_counts, sample_metadata) generate_target(&quot;K01811&quot;, gene_annotations, gene_counts, sample_metadata) generate_target(&quot;K01953&quot;, gene_annotations, gene_counts, sample_metadata) #Around 0.001% generate_target(&quot;K04095&quot;, gene_annotations, gene_counts, sample_metadata) generate_target(&quot;K04784&quot;, gene_annotations, gene_counts, sample_metadata) generate_target(&quot;K00394&quot;, gene_annotations, gene_counts, sample_metadata) #Around 0.0001% generate_target(&quot;K06390&quot;, gene_annotations, gene_counts, sample_metadata) generate_target(&quot;K07813&quot;, gene_annotations, gene_counts, sample_metadata) generate_target(&quot;K06396&quot;, gene_annotations, gene_counts, sample_metadata) 5.2 Differential expression # flagellum generate_target(&quot;K02406|K06603|K02422|K02398|K02407&quot;, gene_annotations, gene_counts, sample_metadata) #chemotaxis generate_target(&quot;K03406&quot;, gene_annotations, gene_counts, sample_metadata) #gluconate generate_target(&quot;K00033|K25031|K07979|K06155&quot;, gene_annotations, gene_counts, sample_metadata) #starch generate_target(&quot;K21572|K21573&quot;, gene_annotations, gene_counts, sample_metadata) 5.3 Biologically relevant generate_target(&quot;GH3&quot;, gene_annotations, gene_counts, sample_metadata) generate_target(&quot;GH77&quot;, gene_annotations, gene_counts, sample_metadata) generate_target(&quot;CE4&quot;, gene_annotations, gene_counts, sample_metadata) generate_target(&quot;CBM48&quot;, gene_annotations, gene_counts, sample_metadata) generate_target(&quot;GT5&quot;, gene_annotations, gene_counts, sample_metadata) 5.4 Run shell screen -S bgu_probe_design_test cd bgu_probe_design_test source activate isms_probe_design_env module load snakemake/7.19.1 snakemake \\ -j 20 \\ --cluster &#39;sbatch -o results/log/{params.jobname}-slurm-%j.out --mem {resources.mem_gb}G --time {resources.time} -c {threads} --job-name={params.jobname} -v&#39; \\ --use-conda --conda-frontend mamba --conda-prefix conda \\ --latency-wait 600 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
